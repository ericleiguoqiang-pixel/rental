import{r as c,c as kr,g as Pr,b as Cr,R as Bt}from"./vendor-fa9da516.js";import{S as Se,A as Z,_ as X,F as v,C as B,I as R,R as J,a as A,B as D,b as Ir,T as we,m as b,L as ut,M as Tr,D as Or,c as Er,d as Mr,e as he,f as ne,g as ee,h as O,i as W,j as ht,k as G,P as Ee,l as le,n as se,E as pe,o as Ye,p as ge,q as Oe,r as Dr,U as $r,s as Rr,t as Q,u as mt,v as Nr,w as Ut,x as Ar,y as $e,z as it,G as Lr,H as wt,J as zr,K as Fr}from"./antd-dc87d52e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();var jt={exports:{}},Ke={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _r=c,Vr=Symbol.for("react.element"),qr=Symbol.for("react.fragment"),Br=Object.prototype.hasOwnProperty,Ur=_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jr={key:!0,ref:!0,__self:!0,__source:!0};function Ht(t,r,a){var n,o={},i=null,d=null;a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(d=r.ref);for(n in r)Br.call(r,n)&&!jr.hasOwnProperty(n)&&(o[n]=r[n]);if(t&&t.defaultProps)for(n in r=t.defaultProps,r)o[n]===void 0&&(o[n]=r[n]);return{$$typeof:Vr,type:t,key:i,ref:d,props:o,_owner:Ur.current}}Ke.Fragment=qr;Ke.jsx=Ht;Ke.jsxs=Ht;jt.exports=Ke;var vt=jt.exports;const fe=vt.Fragment,e=vt.jsx,f=vt.jsxs;var pt={},xt=kr;pt.createRoot=xt.createRoot,pt.hydrateRoot=xt.hydrateRoot;var Ge={},Jt={exports:{}};(function(t){function r(a){return a&&a.__esModule?a:{default:a}}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Jt);var Qe=Jt.exports,Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.default=void 0;var Hr={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};Ze.default=Hr;var Xe={},_e={},et={},Wt={exports:{}},Yt={exports:{}},Kt={exports:{}},Gt={exports:{}};(function(t){function r(a){"@babel/helpers - typeof";return t.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,r(a)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports})(Gt);var Qt=Gt.exports,Zt={exports:{}};(function(t){var r=Qt.default;function a(n,o){if(r(n)!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var d=i.call(n,o||"default");if(r(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports})(Zt);var Jr=Zt.exports;(function(t){var r=Qt.default,a=Jr;function n(o){var i=a(o,"string");return r(i)=="symbol"?i:i+""}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Kt);var Wr=Kt.exports;(function(t){var r=Wr;function a(n,o,i){return(o=r(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports})(Yt);var Yr=Yt.exports;(function(t){var r=Yr;function a(o,i){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(o);i&&(m=m.filter(function(h){return Object.getOwnPropertyDescriptor(o,h).enumerable})),d.push.apply(d,m)}return d}function n(o){for(var i=1;i<arguments.length;i++){var d=arguments[i]!=null?arguments[i]:{};i%2?a(Object(d),!0).forEach(function(m){r(o,m,d[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):a(Object(d)).forEach(function(m){Object.defineProperty(o,m,Object.getOwnPropertyDescriptor(d,m))})}return o}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Wt);var Kr=Wt.exports,tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.commonLocale=void 0;tt.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var Gr=Qe.default;Object.defineProperty(et,"__esModule",{value:!0});et.default=void 0;var kt=Gr(Kr),Qr=tt,Zr=(0,kt.default)((0,kt.default)({},Qr.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",week:"周",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});et.default=Zr;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.default=void 0;const Xr={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};Ve.default=Xr;var Xt=Qe.default;Object.defineProperty(_e,"__esModule",{value:!0});_e.default=void 0;var en=Xt(et),tn=Xt(Ve);const er={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},en.default),timePickerLocale:Object.assign({},tn.default)};er.lang.ok="确定";_e.default=er;var rn=Qe.default;Object.defineProperty(Xe,"__esModule",{value:!0});Xe.default=void 0;var nn=rn(_e);Xe.default=nn.default;var rt=Qe.default;Object.defineProperty(Ge,"__esModule",{value:!0});Ge.default=void 0;var an=rt(Ze),ln=rt(Xe),on=rt(_e),sn=rt(Ve);const re="${label}不是一个有效的${type}",cn={locale:"zh-cn",Pagination:an.default,DatePicker:on.default,TimePicker:sn.default,Calendar:ln.default,global:{placeholder:"请选择",close:"关闭"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckAll:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:re,method:re,array:re,object:re,number:re,date:re,boolean:re,integer:re,float:re,regexp:re,email:re,url:re,hex:re},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};Ge.default=cn;var dn=Ge;const un=Pr(dn);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Le(){return Le=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Le.apply(this,arguments)}var me;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(me||(me={}));const Pt="popstate";function hn(t){t===void 0&&(t={});function r(n,o){let{pathname:i,search:d,hash:m}=n.location;return ft("",{pathname:i,search:d,hash:m},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(n,o){return typeof o=="string"?o:rr(o)}return pn(r,a,null,t)}function Y(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function tr(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function mn(){return Math.random().toString(36).substr(2,8)}function Ct(t,r){return{usr:t.state,key:t.key,idx:r}}function ft(t,r,a,n){return a===void 0&&(a=null),Le({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof r=="string"?Me(r):r,{state:a,key:r&&r.key||n||mn()})}function rr(t){let{pathname:r="/",search:a="",hash:n=""}=t;return a&&a!=="?"&&(r+=a.charAt(0)==="?"?a:"?"+a),n&&n!=="#"&&(r+=n.charAt(0)==="#"?n:"#"+n),r}function Me(t){let r={};if(t){let a=t.indexOf("#");a>=0&&(r.hash=t.substr(a),t=t.substr(0,a));let n=t.indexOf("?");n>=0&&(r.search=t.substr(n),t=t.substr(0,n)),t&&(r.pathname=t)}return r}function pn(t,r,a,n){n===void 0&&(n={});let{window:o=document.defaultView,v5Compat:i=!1}=n,d=o.history,m=me.Pop,h=null,p=y();p==null&&(p=0,d.replaceState(Le({},d.state,{idx:p}),""));function y(){return(d.state||{idx:null}).idx}function u(){m=me.Pop;let P=y(),$=P==null?null:P-p;p=P,h&&h({action:m,location:S.location,delta:$})}function s(P,$){m=me.Push;let I=ft(S.location,P,$);a&&a(I,P),p=y()+1;let q=Ct(I,p),U=S.createHref(I);try{d.pushState(q,"",U)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;o.location.assign(U)}i&&h&&h({action:m,location:S.location,delta:1})}function l(P,$){m=me.Replace;let I=ft(S.location,P,$);a&&a(I,P),p=y();let q=Ct(I,p),U=S.createHref(I);d.replaceState(q,"",U),i&&h&&h({action:m,location:S.location,delta:0})}function g(P){let $=o.location.origin!=="null"?o.location.origin:o.location.href,I=typeof P=="string"?P:rr(P);return I=I.replace(/ $/,"%20"),Y($,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,$)}let S={get action(){return m},get location(){return t(o,d)},listen(P){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(Pt,u),h=P,()=>{o.removeEventListener(Pt,u),h=null}},createHref(P){return r(o,P)},createURL:g,encodeLocation(P){let $=g(P);return{pathname:$.pathname,search:$.search,hash:$.hash}},push:s,replace:l,go(P){return d.go(P)}};return S}var It;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(It||(It={}));function fn(t,r,a){return a===void 0&&(a="/"),gn(t,r,a,!1)}function gn(t,r,a,n){let o=typeof r=="string"?Me(r):r,i=lr(o.pathname||"/",a);if(i==null)return null;let d=nr(t);yn(d);let m=null;for(let h=0;m==null&&h<d.length;++h){let p=On(i);m=In(d[h],p,n)}return m}function nr(t,r,a,n){r===void 0&&(r=[]),a===void 0&&(a=[]),n===void 0&&(n="");let o=(i,d,m)=>{let h={relativePath:m===void 0?i.path||"":m,caseSensitive:i.caseSensitive===!0,childrenIndex:d,route:i};h.relativePath.startsWith("/")&&(Y(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let p=be([n,h.relativePath]),y=a.concat(h);i.children&&i.children.length>0&&(Y(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),nr(i.children,r,y,p)),!(i.path==null&&!i.index)&&r.push({path:p,score:Pn(p,i.index),routesMeta:y})};return t.forEach((i,d)=>{var m;if(i.path===""||!((m=i.path)!=null&&m.includes("?")))o(i,d);else for(let h of ar(i.path))o(i,d,h)}),r}function ar(t){let r=t.split("/");if(r.length===0)return[];let[a,...n]=r,o=a.endsWith("?"),i=a.replace(/\?$/,"");if(n.length===0)return o?[i,""]:[i];let d=ar(n.join("/")),m=[];return m.push(...d.map(h=>h===""?i:[i,h].join("/"))),o&&m.push(...d),m.map(h=>t.startsWith("/")&&h===""?"/":h)}function yn(t){t.sort((r,a)=>r.score!==a.score?a.score-r.score:Cn(r.routesMeta.map(n=>n.childrenIndex),a.routesMeta.map(n=>n.childrenIndex)))}const vn=/^:[\w-]+$/,bn=3,Sn=2,wn=1,xn=10,kn=-2,Tt=t=>t==="*";function Pn(t,r){let a=t.split("/"),n=a.length;return a.some(Tt)&&(n+=kn),r&&(n+=Sn),a.filter(o=>!Tt(o)).reduce((o,i)=>o+(vn.test(i)?bn:i===""?wn:xn),n)}function Cn(t,r){return t.length===r.length&&t.slice(0,-1).every((n,o)=>n===r[o])?t[t.length-1]-r[r.length-1]:0}function In(t,r,a){a===void 0&&(a=!1);let{routesMeta:n}=t,o={},i="/",d=[];for(let m=0;m<n.length;++m){let h=n[m],p=m===n.length-1,y=i==="/"?r:r.slice(i.length)||"/",u=Ot({path:h.relativePath,caseSensitive:h.caseSensitive,end:p},y),s=h.route;if(!u&&p&&a&&!n[n.length-1].route.index&&(u=Ot({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},y)),!u)return null;Object.assign(o,u.params),d.push({params:o,pathname:be([i,u.pathname]),pathnameBase:$n(be([i,u.pathnameBase])),route:s}),u.pathnameBase!=="/"&&(i=be([i,u.pathnameBase]))}return d}function Ot(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,n]=Tn(t.path,t.caseSensitive,t.end),o=r.match(a);if(!o)return null;let i=o[0],d=i.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:n.reduce((p,y,u)=>{let{paramName:s,isOptional:l}=y;if(s==="*"){let S=m[u]||"";d=i.slice(0,i.length-S.length).replace(/(.)\/+$/,"$1")}const g=m[u];return l&&!g?p[s]=void 0:p[s]=(g||"").replace(/%2F/g,"/"),p},{}),pathname:i,pathnameBase:d,pattern:t}}function Tn(t,r,a){r===void 0&&(r=!1),a===void 0&&(a=!0),tr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,h)=>(n.push({paramName:m,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,r?void 0:"i"),n]}function On(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return tr(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),t}}function lr(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,n=t.charAt(a);return n&&n!=="/"?null:t.slice(a)||"/"}function En(t,r){r===void 0&&(r="/");let{pathname:a,search:n="",hash:o=""}=typeof t=="string"?Me(t):t;return{pathname:a?a.startsWith("/")?a:Mn(a,r):r,search:Rn(n),hash:Nn(o)}}function Mn(t,r){let a=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function ot(t,r,a,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Dn(t){return t.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function ir(t,r){let a=Dn(t);return r?a.map((n,o)=>o===a.length-1?n.pathname:n.pathnameBase):a.map(n=>n.pathnameBase)}function or(t,r,a,n){n===void 0&&(n=!1);let o;typeof t=="string"?o=Me(t):(o=Le({},t),Y(!o.pathname||!o.pathname.includes("?"),ot("?","pathname","search",o)),Y(!o.pathname||!o.pathname.includes("#"),ot("#","pathname","hash",o)),Y(!o.search||!o.search.includes("#"),ot("#","search","hash",o)));let i=t===""||o.pathname==="",d=i?"/":o.pathname,m;if(d==null)m=a;else{let u=r.length-1;if(!n&&d.startsWith("..")){let s=d.split("/");for(;s[0]==="..";)s.shift(),u-=1;o.pathname=s.join("/")}m=u>=0?r[u]:"/"}let h=En(o,m),p=d&&d!=="/"&&d.endsWith("/"),y=(i||d===".")&&a.endsWith("/");return!h.pathname.endsWith("/")&&(p||y)&&(h.pathname+="/"),h}const be=t=>t.join("/").replace(/\/\/+/g,"/"),$n=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Rn=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Nn=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function An(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const sr=["post","put","patch","delete"];new Set(sr);const Ln=["get",...sr];new Set(Ln);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ze(){return ze=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},ze.apply(this,arguments)}const bt=c.createContext(null),zn=c.createContext(null),qe=c.createContext(null),nt=c.createContext(null),xe=c.createContext({outlet:null,matches:[],isDataRoute:!1}),cr=c.createContext(null);function Be(){return c.useContext(nt)!=null}function ke(){return Be()||Y(!1),c.useContext(nt).location}function dr(t){c.useContext(qe).static||c.useLayoutEffect(t)}function Ue(){let{isDataRoute:t}=c.useContext(xe);return t?Gn():Fn()}function Fn(){Be()||Y(!1);let t=c.useContext(bt),{basename:r,future:a,navigator:n}=c.useContext(qe),{matches:o}=c.useContext(xe),{pathname:i}=ke(),d=JSON.stringify(ir(o,a.v7_relativeSplatPath)),m=c.useRef(!1);return dr(()=>{m.current=!0}),c.useCallback(function(p,y){if(y===void 0&&(y={}),!m.current)return;if(typeof p=="number"){n.go(p);return}let u=or(p,JSON.parse(d),i,y.relative==="path");t==null&&r!=="/"&&(u.pathname=u.pathname==="/"?r:be([r,u.pathname])),(y.replace?n.replace:n.push)(u,y.state,y)},[r,n,d,i,t])}function _n(t,r){return Vn(t,r)}function Vn(t,r,a,n){Be()||Y(!1);let{navigator:o}=c.useContext(qe),{matches:i}=c.useContext(xe),d=i[i.length-1],m=d?d.params:{};d&&d.pathname;let h=d?d.pathnameBase:"/";d&&d.route;let p=ke(),y;if(r){var u;let P=typeof r=="string"?Me(r):r;h==="/"||(u=P.pathname)!=null&&u.startsWith(h)||Y(!1),y=P}else y=p;let s=y.pathname||"/",l=s;if(h!=="/"){let P=h.replace(/^\//,"").split("/");l="/"+s.replace(/^\//,"").split("/").slice(P.length).join("/")}let g=fn(t,{pathname:l}),S=Hn(g&&g.map(P=>Object.assign({},P,{params:Object.assign({},m,P.params),pathname:be([h,o.encodeLocation?o.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?h:be([h,o.encodeLocation?o.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),i,a,n);return r&&S?c.createElement(nt.Provider,{value:{location:ze({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:me.Pop}},S):S}function qn(){let t=Kn(),r=An(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return c.createElement(c.Fragment,null,c.createElement("h2",null,"Unexpected Application Error!"),c.createElement("h3",{style:{fontStyle:"italic"}},r),a?c.createElement("pre",{style:o},a):null,i)}const Bn=c.createElement(qn,null);class Un extends c.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,a){return a.location!==r.location||a.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:a.error,location:a.location,revalidation:r.revalidation||a.revalidation}}componentDidCatch(r,a){console.error("React Router caught the following error during render",r,a)}render(){return this.state.error!==void 0?c.createElement(xe.Provider,{value:this.props.routeContext},c.createElement(cr.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jn(t){let{routeContext:r,match:a,children:n}=t,o=c.useContext(bt);return o&&o.static&&o.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=a.route.id),c.createElement(xe.Provider,{value:r},n)}function Hn(t,r,a,n){var o;if(r===void 0&&(r=[]),a===void 0&&(a=null),n===void 0&&(n=null),t==null){var i;if(!a)return null;if(a.errors)t=a.matches;else if((i=n)!=null&&i.v7_partialHydration&&r.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let d=t,m=(o=a)==null?void 0:o.errors;if(m!=null){let y=d.findIndex(u=>u.route.id&&(m==null?void 0:m[u.route.id])!==void 0);y>=0||Y(!1),d=d.slice(0,Math.min(d.length,y+1))}let h=!1,p=-1;if(a&&n&&n.v7_partialHydration)for(let y=0;y<d.length;y++){let u=d[y];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(p=y),u.route.id){let{loaderData:s,errors:l}=a,g=u.route.loader&&s[u.route.id]===void 0&&(!l||l[u.route.id]===void 0);if(u.route.lazy||g){h=!0,p>=0?d=d.slice(0,p+1):d=[d[0]];break}}}return d.reduceRight((y,u,s)=>{let l,g=!1,S=null,P=null;a&&(l=m&&u.route.id?m[u.route.id]:void 0,S=u.route.errorElement||Bn,h&&(p<0&&s===0?(Qn("route-fallback",!1),g=!0,P=null):p===s&&(g=!0,P=u.route.hydrateFallbackElement||null)));let $=r.concat(d.slice(0,s+1)),I=()=>{let q;return l?q=S:g?q=P:u.route.Component?q=c.createElement(u.route.Component,null):u.route.element?q=u.route.element:q=y,c.createElement(jn,{match:u,routeContext:{outlet:y,matches:$,isDataRoute:a!=null},children:q})};return a&&(u.route.ErrorBoundary||u.route.errorElement||s===0)?c.createElement(Un,{location:a.location,revalidation:a.revalidation,component:S,error:l,children:I(),routeContext:{outlet:null,matches:$,isDataRoute:!0}}):I()},null)}var ur=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ur||{}),We=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(We||{});function Jn(t){let r=c.useContext(bt);return r||Y(!1),r}function Wn(t){let r=c.useContext(zn);return r||Y(!1),r}function Yn(t){let r=c.useContext(xe);return r||Y(!1),r}function hr(t){let r=Yn(),a=r.matches[r.matches.length-1];return a.route.id||Y(!1),a.route.id}function Kn(){var t;let r=c.useContext(cr),a=Wn(We.UseRouteError),n=hr(We.UseRouteError);return r!==void 0?r:(t=a.errors)==null?void 0:t[n]}function Gn(){let{router:t}=Jn(ur.UseNavigateStable),r=hr(We.UseNavigateStable),a=c.useRef(!1);return dr(()=>{a.current=!0}),c.useCallback(function(o,i){i===void 0&&(i={}),a.current&&(typeof o=="number"?t.navigate(o):t.navigate(o,ze({fromRouteId:r},i)))},[t,r])}const Et={};function Qn(t,r,a){!r&&!Et[t]&&(Et[t]=!0)}function Zn(t,r){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!r||r.v7_relativeSplatPath),r&&(r.v7_fetcherPersist,r.v7_normalizeFormMethod,r.v7_partialHydration,r.v7_skipActionErrorRevalidation)}function mr(t){let{to:r,replace:a,state:n,relative:o}=t;Be()||Y(!1);let{future:i,static:d}=c.useContext(qe),{matches:m}=c.useContext(xe),{pathname:h}=ke(),p=Ue(),y=or(r,ir(m,i.v7_relativeSplatPath),h,o==="path"),u=JSON.stringify(y);return c.useEffect(()=>p(JSON.parse(u),{replace:a,state:n,relative:o}),[p,u,o,a,n]),null}function K(t){Y(!1)}function Xn(t){let{basename:r="/",children:a=null,location:n,navigationType:o=me.Pop,navigator:i,static:d=!1,future:m}=t;Be()&&Y(!1);let h=r.replace(/^\/*/,"/"),p=c.useMemo(()=>({basename:h,navigator:i,static:d,future:ze({v7_relativeSplatPath:!1},m)}),[h,m,i,d]);typeof n=="string"&&(n=Me(n));let{pathname:y="/",search:u="",hash:s="",state:l=null,key:g="default"}=n,S=c.useMemo(()=>{let P=lr(y,h);return P==null?null:{location:{pathname:P,search:u,hash:s,state:l,key:g},navigationType:o}},[h,y,u,s,l,g,o]);return S==null?null:c.createElement(qe.Provider,{value:p},c.createElement(nt.Provider,{children:a,value:S}))}function ea(t){let{children:r,location:a}=t;return _n(gt(r),a)}new Promise(()=>{});function gt(t,r){r===void 0&&(r=[]);let a=[];return c.Children.forEach(t,(n,o)=>{if(!c.isValidElement(n))return;let i=[...r,o];if(n.type===c.Fragment){a.push.apply(a,gt(n.props.children,i));return}n.type!==K&&Y(!1),!n.props.index||!n.props.children||Y(!1);let d={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(d.children=gt(n.props.children,i)),a.push(d)}),a}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ta="6";try{window.__reactRouterVersion=ta}catch{}const ra="startTransition",Mt=Cr[ra];function na(t){let{basename:r,children:a,future:n,window:o}=t,i=c.useRef();i.current==null&&(i.current=hn({window:o,v5Compat:!0}));let d=i.current,[m,h]=c.useState({action:d.action,location:d.location}),{v7_startTransition:p}=n||{},y=c.useCallback(u=>{p&&Mt?Mt(()=>h(u)):h(u)},[h,p]);return c.useLayoutEffect(()=>d.listen(y),[d,y]),c.useEffect(()=>Zn(n),[n]),c.createElement(Xn,{basename:r,children:a,location:m.location,navigationType:m.action,navigator:d,future:n})}var Dt;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Dt||(Dt={}));var $t;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})($t||($t={}));const ue=({children:t})=>{const[r,a]=c.useState(null),[n,o]=c.useState(!0),i=ke();c.useEffect(()=>{d()},[]);const d=async()=>{try{const m=localStorage.getItem("token"),h=localStorage.getItem("userInfo");if(console.log("AuthGuard 检查认证状态:",{hasToken:!!m,hasUserInfo:!!h}),!m||!h){console.log("缺少 token 或 userInfo，设置为未认证"),a(!1),o(!1);return}try{const p=await fetch("/api/auth/verify",{method:"POST",headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});p.ok?(console.log("Token 验证成功"),a(!0)):(console.log("Token 验证失败，状态码:",p.status),localStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("refreshToken"),a(!1))}catch(p){console.warn("Token 验证接口调用失败:",p),m&&m.length>10&&!m.startsWith("undefined")?(console.log("后端服务不可用，但本地有有效token，允许访问"),a(!0)):(console.log("token无效或后端服务不可用，设置为未认证"),a(!1))}}catch(m){console.error("认证检查失败:",m),a(!1)}finally{o(!1)}};return n?f("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column"},children:[e(Se,{size:"large"}),e("p",{style:{marginTop:16,color:"#666"},children:"正在验证身份..."})]}):r?e(fe,{children:t}):e(mr,{to:"/login",state:{from:i},replace:!0})};var aa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"};const la=aa;var ia=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:la}))},oa=c.forwardRef(ia);const Rt=oa;var sa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M380 704h264c4.4 0 8-3.6 8-8v-84c0-4.4-3.6-8-8-8h-40c-4.4 0-8 3.6-8 8v36H428v-36c0-4.4-3.6-8-8-8h-40c-4.4 0-8 3.6-8 8v84c0 4.4 3.6 8 8 8zm340-123a40 40 0 1080 0 40 40 0 10-80 0zm239-167.6L935.3 372a8 8 0 00-10.9-2.9l-50.7 29.6-78.3-216.2a63.9 63.9 0 00-60.9-44.4H301.2c-34.7 0-65.5 22.4-76.2 55.5l-74.6 205.2-50.8-29.6a8 8 0 00-10.9 2.9L65 413.4c-2.2 3.8-.9 8.6 2.9 10.8l60.4 35.2-14.5 40c-1.2 3.2-1.8 6.6-1.8 10v348.2c0 15.7 11.8 28.4 26.3 28.4h67.6c12.3 0 23-9.3 25.6-22.3l7.7-37.7h545.6l7.7 37.7c2.7 13 13.3 22.3 25.6 22.3h67.6c14.5 0 26.3-12.7 26.3-28.4V509.4c0-3.4-.6-6.8-1.8-10l-14.5-40 60.3-35.2a8 8 0 003-10.8zM840 517v237H184V517l15.6-43h624.8l15.6 43zM292.7 218.1l.5-1.3.4-1.3c1.1-3.3 4.1-5.5 7.6-5.5h427.6l75.4 208H220l72.7-199.9zM224 581a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"car",theme:"outlined"};const ca=sa;var da=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:ca}))},ua=c.forwardRef(da);const pr=ua;var ha={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};const ma=ha;var pa=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:ma}))},fa=c.forwardRef(pa);const yt=fa;var ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 385.6a446.7 446.7 0 00-96-142.4 446.7 446.7 0 00-142.4-96C631.1 123.8 572.5 112 512 112s-119.1 11.8-174.4 35.2a446.7 446.7 0 00-142.4 96 446.7 446.7 0 00-96 142.4C75.8 440.9 64 499.5 64 560c0 132.7 58.3 257.7 159.9 343.1l1.7 1.4c5.8 4.8 13.1 7.5 20.6 7.5h531.7c7.5 0 14.8-2.7 20.6-7.5l1.7-1.4C901.7 817.7 960 692.7 960 560c0-60.5-11.9-119.1-35.2-174.4zM761.4 836H262.6A371.12 371.12 0 01140 560c0-99.4 38.7-192.8 109-263 70.3-70.3 163.7-109 263-109 99.4 0 192.8 38.7 263 109 70.3 70.3 109 163.7 109 263 0 105.6-44.5 205.5-122.6 276zM623.5 421.5a8.03 8.03 0 00-11.3 0L527.7 506c-18.7-5-39.4-.2-54.1 14.5a55.95 55.95 0 000 79.2 55.95 55.95 0 0079.2 0 55.87 55.87 0 0014.5-54.1l84.5-84.5c3.1-3.1 3.1-8.2 0-11.3l-28.3-28.3zM490 320h44c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8h-44c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8zm260 218v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8zm12.7-197.2l-31.1-31.1a8.03 8.03 0 00-11.3 0l-56.6 56.6a8.03 8.03 0 000 11.3l31.1 31.1c3.1 3.1 8.2 3.1 11.3 0l56.6-56.6c3.1-3.1 3.1-8.2 0-11.3zm-458.6-31.1a8.03 8.03 0 00-11.3 0l-31.1 31.1a8.03 8.03 0 000 11.3l56.6 56.6c3.1 3.1 8.2 3.1 11.3 0l31.1-31.1c3.1-3.1 3.1-8.2 0-11.3l-56.6-56.6zM262 530h-80c-4.4 0-8 3.6-8 8v44c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8v-44c0-4.4-3.6-8-8-8z"}}]},name:"dashboard",theme:"outlined"};const ya=ga;var va=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:ya}))},ba=c.forwardRef(va);const Sa=ba;var wa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm376 116c-119.3 0-216 96.7-216 216s96.7 216 216 216 216-96.7 216-216-96.7-216-216-216zm107.5 323.5C750.8 868.2 712.6 884 672 884s-78.8-15.8-107.5-44.5C535.8 810.8 520 772.6 520 732s15.8-78.8 44.5-107.5C593.2 595.8 631.4 580 672 580s78.8 15.8 107.5 44.5C808.2 653.2 824 691.4 824 732s-15.8 78.8-44.5 107.5zM761 656h-44.3c-2.6 0-5 1.2-6.5 3.3l-63.5 87.8-23.1-31.9a7.92 7.92 0 00-6.5-3.3H573c-6.5 0-10.3 7.4-6.5 12.7l73.8 102.1c3.2 4.4 9.7 4.4 12.9 0l114.2-158c3.9-5.3.1-12.7-6.4-12.7zM440 852H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"file-done",theme:"outlined"};const xa=wa;var ka=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:xa}))},Pa=c.forwardRef(ka);const Ca=Pa;var Ia={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const Ta=Ia;var Oa=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:Ta}))},Ea=c.forwardRef(Oa);const Ma=Ea;var Da={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"};const $a=Da;var Ra=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:$a}))},Na=c.forwardRef(Ra);const Aa=Na;var La={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 000 13.8z"}}]},name:"menu-fold",theme:"outlined"};const za=La;var Fa=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:za}))},_a=c.forwardRef(Fa);const Va=_a;var qa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 000-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0014.4 7z"}}]},name:"menu-unfold",theme:"outlined"};const Ba=qa;var Ua=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:Ba}))},ja=c.forwardRef(Ua);const Ha=ja;var Ja={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};const Wa=Ja;var Ya=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:Wa}))},Ka=c.forwardRef(Ya);const Ga=Ka;var Qa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M882 272.1V144c0-17.7-14.3-32-32-32H174c-17.7 0-32 14.3-32 32v128.1c-16.7 1-30 14.9-30 31.9v131.7a177 177 0 0014.4 70.4c4.3 10.2 9.6 19.8 15.6 28.9v345c0 17.6 14.3 32 32 32h676c17.7 0 32-14.3 32-32V535a175 175 0 0015.6-28.9c9.5-22.3 14.4-46 14.4-70.4V304c0-17-13.3-30.9-30-31.9zM214 184h596v88H214v-88zm362 656.1H448V736h128v104.1zm234 0H640V704c0-17.7-14.3-32-32-32H416c-17.7 0-32 14.3-32 32v136.1H214V597.9c2.9 1.4 5.9 2.8 9 4 22.3 9.4 46 14.1 70.4 14.1s48-4.7 70.4-14.1c13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 3-1.3 6-2.6 9-4v242.2zm30-404.4c0 59.8-49 108.3-109.3 108.3-40.8 0-76.4-22.1-95.2-54.9-2.9-5-8.1-8.1-13.9-8.1h-.6c-5.7 0-11 3.1-13.9 8.1A109.24 109.24 0 01512 544c-40.7 0-76.2-22-95-54.7-3-5.1-8.4-8.3-14.3-8.3s-11.4 3.2-14.3 8.3a109.63 109.63 0 01-95.1 54.7C233 544 184 495.5 184 435.7v-91.2c0-.3.2-.5.5-.5h655c.3 0 .5.2.5.5v91.2z"}}]},name:"shop",theme:"outlined"};const Za=Qa;var Xa=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:Za}))},el=c.forwardRef(Xa);const tl=el;var rl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 312H696v-16c0-101.6-82.4-184-184-184s-184 82.4-184 184v16H192c-17.7 0-32 14.3-32 32v536c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V344c0-17.7-14.3-32-32-32zm-432-16c0-61.9 50.1-112 112-112s112 50.1 112 112v16H400v-16zm392 544H232V384h96v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h224v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h96v456z"}}]},name:"shopping",theme:"outlined"};const nl=rl;var al=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:nl}))},ll=c.forwardRef(al);const il=ll;var ol={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M824.2 699.9a301.55 301.55 0 00-86.4-60.4C783.1 602.8 812 546.8 812 484c0-110.8-92.4-201.7-203.2-200-109.1 1.7-197 90.6-197 200 0 62.8 29 118.8 74.2 155.5a300.95 300.95 0 00-86.4 60.4C345 754.6 314 826.8 312 903.8a8 8 0 008 8.2h56c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5A226.62 226.62 0 01612 684c60.9 0 118.2 23.7 161.3 66.8C814.5 792 838 846.3 840 904.3c.1 4.3 3.7 7.7 8 7.7h56a8 8 0 008-8.2c-2-77-33-149.2-87.8-203.9zM612 612c-34.2 0-66.4-13.3-90.5-37.5a126.86 126.86 0 01-37.5-91.8c.3-32.8 13.4-64.5 36.3-88 24-24.6 56.1-38.3 90.4-38.7 33.9-.3 66.8 12.9 91 36.6 24.8 24.3 38.4 56.8 38.4 91.4 0 34.2-13.3 66.3-37.5 90.5A127.3 127.3 0 01612 612zM361.5 510.4c-.9-8.7-1.4-17.5-1.4-26.4 0-15.9 1.5-31.4 4.3-46.5.7-3.6-1.2-7.3-4.5-8.8-13.6-6.1-26.1-14.5-36.9-25.1a127.54 127.54 0 01-38.7-95.4c.9-32.1 13.8-62.6 36.3-85.6 24.7-25.3 57.9-39.1 93.2-38.7 31.9.3 62.7 12.6 86 34.4 7.9 7.4 14.7 15.6 20.4 24.4 2 3.1 5.9 4.4 9.3 3.2 17.6-6.1 36.2-10.4 55.3-12.4 5.6-.6 8.8-6.6 6.3-11.6-32.5-64.3-98.9-108.7-175.7-109.9-110.9-1.7-203.3 89.2-203.3 199.9 0 62.8 28.9 118.8 74.2 155.5-31.8 14.7-61.1 35-86.5 60.4-54.8 54.7-85.8 126.9-87.8 204a8 8 0 008 8.2h56.1c4.3 0 7.9-3.4 8-7.7 1.9-58 25.4-112.3 66.7-153.5 29.4-29.4 65.4-49.8 104.7-59.7 3.9-1 6.5-4.7 6-8.7z"}}]},name:"team",theme:"outlined"};const sl=ol;var cl=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:sl}))},dl=c.forwardRef(cl);const ul=dl;var hl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};const ml=hl;var pl=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:ml}))},fl=c.forwardRef(pl);const Nt=fl;var gl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};const yl=gl;var vl=function(r,a){return c.createElement(Z,X({},r,{ref:a,icon:yl}))},bl=c.forwardRef(vl);const Fe=bl,Sl="/api",M=async(t,r={})=>{const a=localStorage.getItem("token");let n="1";try{const i=localStorage.getItem("userInfo");if(i){const d=JSON.parse(i);d.tenantId&&(n=d.tenantId.toString())}}catch(i){console.warn("解析用户信息失败:",i)}const o={headers:{"Content-Type":"application/json",...a&&{Authorization:`Bearer ${a}`},"X-Tenant-Id":n,...r.headers},...r};try{const i=await fetch(`${Sl}${t}`,o);if(!i.ok){if(i.status===401)throw localStorage.removeItem("token"),window.location.href="/login",new Error("身份验证失效，请重新登录");let m=`请求失败: ${i.status}`;try{const h=await i.json();h.message&&(m=h.message)}catch{}throw new Error(m)}const d=await i.json();if(d&&d.code!==200)throw new Error(d.message||"业务处理失败");return d}catch(i){throw console.error("API request failed:",i),i}},ce={getStores:()=>M("/stores?current=1&size=100"),createStore:t=>M("/stores",{method:"POST",body:JSON.stringify(t)}),updateStore:(t,r)=>M(`/stores/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteStore:t=>M(`/stores/${t}`,{method:"DELETE"}),onlineStore:t=>M(`/stores/${t}/online`,{method:"POST"}),offlineStore:t=>M(`/stores/${t}/offline`,{method:"POST"})},Ae={getVehicles:()=>M("/vehicles?current=1&size=100"),createVehicle:t=>M("/vehicles",{method:"POST",body:JSON.stringify(t)}),updateVehicle:(t,r)=>M(`/vehicles/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteVehicle:t=>M(`/vehicles/${t}`,{method:"DELETE"})},Te={getOrders:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/orders${r?"?"+r:""}`)},getOrderDetail:t=>M(`/orders/${t}`),assignPickupDriver:(t,r)=>M(`/orders/${t}/pickup-driver?driverName=${encodeURIComponent(r)}`,{method:"PUT"}),assignReturnDriver:(t,r)=>M(`/orders/${t}/return-driver?driverName=${encodeURIComponent(r)}`,{method:"PUT"}),confirmPickup:t=>M(`/orders/${t}/confirm-pickup`,{method:"PUT"}),confirmReturn:t=>M(`/orders/${t}/confirm-return`,{method:"PUT"})},At={login:t=>M("/auth/login",{method:"POST",body:JSON.stringify(t)}),refreshToken:t=>M("/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:t})}),getCaptcha:()=>M("/auth/captcha"),logout:t=>M("/auth/logout",{method:"POST",headers:{Authorization:`Bearer ${t}`}})},fr={getAllCarModels:()=>M("/car-models/all"),getCarModels:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/car-models${r?"?"+r:""}`)},getCarModelsByBrand:t=>M(`/car-models/brand/${t}`),getAllBrands:()=>M("/car-models/brands"),getSeriesByBrand:t=>M(`/car-models/series?brand=${t}`)},He={listByStoreId:t=>M(`/service-area/list?storeId=${t}`),pageServiceAreas:t=>{const r=new URLSearchParams(t).toString();return M(`/service-area/page${r?"?"+r:""}`)},create:t=>M("/service-area/save",{method:"POST",body:JSON.stringify(t)}),update:t=>M("/service-area/update",{method:"PUT",body:JSON.stringify(t)}),delete:t=>M(`/service-area/delete/${t}`,{method:"DELETE"})},Re={createProduct:t=>M("/car-model-products",{method:"POST",body:JSON.stringify(t)}),updateProduct:(t,r)=>M(`/car-model-products/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteProduct:t=>M(`/car-model-products/${t}`,{method:"DELETE"}),getProduct:t=>M(`/car-model-products/${t}`),getProductList:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/car-model-products${r?"?"+r:""}`)},onlineProduct:t=>M(`/car-model-products/${t}/online`,{method:"PUT"}),offlineProduct:t=>M(`/car-model-products/${t}/offline`,{method:"PUT"})},ae={getValueAddedServiceTemplateList:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/value-added-service-templates${r?"?"+r:""}`)},createValueAddedServiceTemplate:t=>M("/value-added-service-templates",{method:"POST",body:JSON.stringify(t)}),updateValueAddedServiceTemplate:(t,r)=>M(`/value-added-service-templates/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteValueAddedServiceTemplate:t=>M(`/value-added-service-templates/${t}`,{method:"DELETE"}),getCancellationRuleTemplateList:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/cancellation-rule-templates${r?"?"+r:""}`)},createCancellationRuleTemplate:t=>M("/cancellation-rule-templates",{method:"POST",body:JSON.stringify(t)}),updateCancellationRuleTemplate:(t,r)=>M(`/cancellation-rule-templates/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteCancellationRuleTemplate:t=>M(`/cancellation-rule-templates/${t}`,{method:"DELETE"}),getServicePolicyTemplateList:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/service-policy-templates${r?"?"+r:""}`)},createServicePolicyTemplate:t=>M("/service-policy-templates",{method:"POST",body:JSON.stringify(t)}),updateServicePolicyTemplate:(t,r)=>M(`/service-policy-templates/${t}`,{method:"PUT",body:JSON.stringify(r)}),deleteServicePolicyTemplate:t=>M(`/service-policy-templates/${t}`,{method:"DELETE"})},Je={createPricing:t=>M("/special-pricings",{method:"POST",body:JSON.stringify(t)}),updatePricing:(t,r)=>M(`/special-pricings/${t}`,{method:"PUT",body:JSON.stringify(r)}),deletePricing:t=>M(`/special-pricings/${t}`,{method:"DELETE"}),getPricing:t=>M(`/special-pricings/${t}`),getPricingList:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/special-pricings${r?"?"+r:""}`)},getPricingsByProduct:t=>M(`/special-pricings/product/${t}`),getPricingsByProductForCalendar:t=>M(`/special-pricings/product/${t}/calendar`)},st={getRelatedVehicles:t=>M(`/product-vehicle-relations/product/${t}`),relateVehicles:t=>M("/product-vehicle-relations/batch",{method:"POST",body:JSON.stringify(t)}),unrelateVehicles:t=>M("/product-vehicle-relations/batch",{method:"DELETE",body:JSON.stringify(t)}),getAvailableVehiclesForProduct:t=>M(`/product-vehicle-relations/product/${t}/vehicles`)},Ne={createEmployee:t=>M("/employees",{method:"POST",body:JSON.stringify(t)}),updateEmployee:t=>M("/employees",{method:"PUT",body:JSON.stringify(t)}),deleteEmployee:t=>M(`/employees/${t}`,{method:"DELETE"}),getEmployee:t=>M(`/employees/${t}`),getEmployees:t=>{const r=t?new URLSearchParams(t).toString():"";return M(`/employees${r?"?"+r:""}`)},resetPassword:t=>M(`/employees/${t}/reset-password`,{method:"PUT"})},{Title:Lt}=we,wl=()=>{var s,l;const t=Ue(),r=ke(),[a]=v.useForm(),[n,o]=c.useState(!1),[i,d]=c.useState(""),[m,h]=c.useState(""),p=((l=(s=r.state)==null?void 0:s.from)==null?void 0:l.pathname)||"/dashboard",y=async()=>{try{const g=await At.getCaptcha(),[S,P]=g.data.split(":");d(S),h(P)}catch(g){console.error("获取验证码失败:",g);const S="captcha_"+Date.now(),P=Math.random().toString(36).substring(2,6).toUpperCase();d(S),h(P)}};return c.useEffect(()=>{const g=localStorage.getItem("token"),S=localStorage.getItem("userInfo");if(g&&S){console.log("用户已登录，跳转到目标页面"),t(p,{replace:!0});return}y()},[]),e("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:f(B,{style:{width:"100%",maxWidth:400,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",borderRadius:12},children:[e(Lt,{level:2,style:{textAlign:"center",marginBottom:8},children:"租车SaaS系统"}),e(Lt,{level:4,style:{textAlign:"center",marginBottom:32,color:"#666"},children:"商户端管理平台"}),f(v,{form:a,name:"login",onFinish:async g=>{o(!0);try{console.log("登录信息:",g);const S=await At.login({username:g.username,password:g.password,captcha:g.captcha,captchaKey:i});S.code===200?(localStorage.setItem("token",S.data.accessToken||S.data.token),localStorage.setItem("refreshToken",S.data.refreshToken),localStorage.setItem("userInfo",JSON.stringify(S.data.userInfo)),b.success("登录成功！"),t(p,{replace:!0})):(b.error(S.message||"登录失败"),y(),a.setFieldValue("captcha",""))}catch(S){console.error("登录失败:",S),S.message.includes("Failed to fetch")||S.message.includes("Network Error")?(b.warning("后端服务暂时不可用，使用模拟登录"),localStorage.setItem("token","mock_token_"+Date.now()),localStorage.setItem("userInfo",JSON.stringify({userId:1,username:g.username,employeeName:"模拟管理员",roleType:1,roleTypeDesc:"超级管理员"})),b.success("登录成功！"),t(p,{replace:!0})):(b.error("登录失败，请检查用户名和密码"),y(),a.setFieldValue("captcha",""))}finally{o(!1)}},autoComplete:"off",size:"large",children:[e(v.Item,{name:"username",rules:[{required:!0,message:"请输入用户名"},{min:4,message:"用户名至少4个字符"}],children:e(R,{prefix:e(Fe,{}),placeholder:"用户名/手机号"})}),e(v.Item,{name:"password",rules:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6个字符"}],children:e(R.Password,{prefix:e(Ma,{}),placeholder:"密码"})}),e(v.Item,{name:"captcha",rules:[{required:!0,message:"请输入验证码"}],children:f(J,{gutter:8,children:[e(A,{span:14,children:e(R,{placeholder:"验证码"})}),e(A,{span:10,children:e(D,{onClick:y,icon:e(Ir,{}),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:m||"获取验证码"})})]})}),e(v.Item,{children:e(D,{type:"primary",htmlType:"submit",loading:n,block:!0,children:"登录"})})]}),e("div",{style:{textAlign:"center",marginTop:24},children:e(D,{type:"link",onClick:()=>t("/register"),children:"没有账户？立即注册"})})]})})},{Header:xl,Sider:kl,Content:Pl}=ut,{Title:zt}=we,ye=({children:t,title:r="仪表盘"})=>{const a=Ue(),n=ke(),[o,i]=c.useState(!1),d=()=>{const u=n.pathname;return u==="/"||u==="/dashboard"?["dashboard"]:u==="/stores"?["stores"]:u==="/vehicles"?["vehicles"]:u==="/orders"?["orders"]:u==="/products"?["products"]:u==="/templates"?["templates"]:u==="/employees"?["employees"]:["dashboard"]},m=({key:u})=>{switch(u){case"dashboard":a("/");break;case"stores":a("/stores");break;case"vehicles":a("/vehicles");break;case"orders":a("/orders");break;case"products":a("/products");break;case"templates":a("/templates");break;case"employees":a("/employees");break}},h=[{key:"dashboard",icon:e(Sa,{}),label:"仪表盘"},{key:"stores",icon:e(tl,{}),label:"门店管理"},{key:"vehicles",icon:e(pr,{}),label:"车辆管理"},{key:"products",icon:e(il,{}),label:"商品管理"},{key:"templates",icon:e(Ca,{}),label:"模板管理"},{key:"orders",icon:e(Mr,{}),label:"订单管理"},{key:"employees",icon:e(ul,{}),label:"员工管理"}],y=[{key:"profile",icon:e(Fe,{}),label:"个人信息"},{key:"settings",icon:e(Ga,{}),label:"设置"},{type:"divider"},{key:"logout",icon:e(Aa,{}),label:"退出登录",onClick:()=>{localStorage.removeItem("token"),a("/login")}}];return f(ut,{style:{minHeight:"100vh"},children:[f(kl,{trigger:null,collapsible:!0,collapsed:o,style:{background:"#fff",boxShadow:"2px 0 8px 0 rgba(29,35,41,.05)"},children:[e("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:"center",borderBottom:"1px solid #f0f0f0"},children:e(zt,{level:4,style:{margin:0,color:"#1890ff"},children:o?"租赁":"租赁管理系统"})}),e(Tr,{mode:"inline",selectedKeys:d(),onClick:m,items:h,style:{borderRight:0,marginTop:16}})]}),f(ut,{children:[f(xl,{style:{padding:"0 16px",background:"#fff",display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px solid #f0f0f0"},children:[f("div",{style:{display:"flex",alignItems:"center"},children:[e(D,{type:"text",icon:o?e(Ha,{}):e(Va,{}),onClick:()=>i(!o),style:{marginRight:16}}),e(zt,{level:4,style:{margin:0},children:r})]}),e(Or,{menu:{items:y},placement:"bottomRight",children:f("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",borderRadius:6,transition:"background-color 0.3s"},children:[e(Er,{size:"small",icon:e(Fe,{})}),e("span",{style:{marginLeft:8},children:"管理员"})]})})]}),e(Pl,{style:{margin:"16px",padding:"24px",background:"#fff",borderRadius:6,boxShadow:"0 1px 3px 0 rgba(0,0,0,0.1)",overflow:"auto"},children:t})]})]})},Cl=()=>{const[t,r]=c.useState({todayOrders:0,todayRevenue:0,availableVehicles:0,rentedVehicles:0}),[a,n]=c.useState(!1),[o,i]=c.useState(null),d=async()=>{try{n(!0),i(null);const m=await M("/dashboard/stats");r(m.data||{todayOrders:0,todayRevenue:0,availableVehicles:0,rentedVehicles:0})}catch(m){const h=m instanceof Error?m.message:"获取仪表盘数据失败";i(h),r({todayOrders:12,todayRevenue:8560,availableVehicles:28,rentedVehicles:15}),console.warn("仪表盘API调用失败，使用模拟数据:",h)}finally{n(!1)}};return c.useEffect(()=>{d()},[]),{stats:t,loading:a,error:o,fetchStats:d}},{Title:Il}=we,Tl=()=>{const{stats:t,loading:r}=Cl();return e(ye,{title:"仪表盘",children:f(Se,{spinning:r,children:[f(J,{gutter:16,style:{marginBottom:24},children:[e(A,{span:6,children:e(B,{children:e(he,{title:"今日订单",value:t.todayOrders,valueStyle:{color:"#3f8600"},prefix:e(Rt,{}),suffix:"单"})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"今日收入",value:t.todayRevenue,precision:2,valueStyle:{color:"#3f8600"},prefix:"¥",suffix:e(Rt,{})})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"可用车辆",value:t.availableVehicles,valueStyle:{color:"#1890ff"},suffix:"辆"})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"租出车辆",value:t.rentedVehicles,valueStyle:{color:"#cf1322"},suffix:"辆"})})})]}),f(B,{children:[e(Il,{level:3,children:"欢迎使用租车SaaS系统"}),e("p",{children:"这是一个功能完善的租车行业数字化管理平台"}),e("p",{children:"您可以通过左侧菜单访问各个功能模块："}),f("ul",{children:[f("li",{children:[e("strong",{children:"门店管理"}),"：管理您的门店信息和营业状态"]}),f("li",{children:[e("strong",{children:"车辆管理"}),"：管理车辆信息、车型库和车辆审核"]}),f("li",{children:[e("strong",{children:"订单管理"}),"：查看和处理客户订单"]}),f("li",{children:[e("strong",{children:"支付管理"}),"：管理支付记录和退款"]}),f("li",{children:[e("strong",{children:"员工管理"}),"：管理员工账户和权限"]})]})]})]})})},Ol=({visible:t,onCancel:r,onConfirm:a,initialLocation:n})=>{const o=c.useRef(null),i=c.useRef(null),d=c.useRef(null),[m,h]=c.useState(n||null);c.useEffect(()=>(t&&o.current&&!i.current&&p(),t&&i.current&&n&&(h(n),y(n)),()=>{i.current&&(i.current.destroy(),i.current=null)}),[t,n]);const p=()=>{if(o.current){if(typeof window.AMap>"u"){b.error("地图加载失败，请检查网络连接");return}try{const s=new window.AMap.Map(o.current,{zoom:11,center:n?[n.longitude,n.latitude]:[116.397428,39.90923]});i.current=s,s.on("click",l=>{const g={longitude:l.lnglat.getLng(),latitude:l.lnglat.getLat()};h(g),y(g)}),n&&y(n)}catch(s){console.error("初始化地图错误:",s),b.error("地图初始化失败")}}},y=s=>{if(i.current){d.current&&i.current.remove(d.current);try{const l=new window.AMap.Marker({position:[s.longitude,s.latitude],draggable:!0,cursor:"move"});l.on("dragend",g=>{const S=g.lnglat,P={longitude:S.getLng(),latitude:S.getLat()};h(P)}),i.current.add(l),d.current=l,i.current.setFitView([l])}catch(l){console.error("创建标记错误:",l),b.error("设置位置时出现错误")}}};return f(ne,{title:"选择门店位置",open:t,onCancel:r,onOk:()=>{if(!m){b.warning("请先在地图上选择位置");return}a(m)},width:800,children:[e("div",{style:{marginBottom:16},children:e("p",{children:"点击地图选择门店位置，可拖拽标记调整位置"})}),e("div",{ref:o,style:{width:"100%",height:"400px"}}),m&&f("div",{style:{marginTop:16},children:[e("p",{children:"当前选择位置："}),f("p",{children:["经度: ",m.longitude.toFixed(6)]}),f("p",{children:["纬度: ",m.latitude.toFixed(6)]})]})]})},El=({visible:t,onCancel:r,onSubmit:a,initialValues:n,title:o})=>{const[i]=v.useForm(),[d,m]=c.useState(!1),[h,p]=c.useState(null),y=async()=>{try{const l=await i.validateFields();l.businessStartTime&&(l.businessStartTime=l.businessStartTime.format("HH:mm")),l.businessEndTime&&(l.businessEndTime=l.businessEndTime.format("HH:mm")),h?(l.longitude=h.longitude,l.latitude=h.latitude):n!=null&&n.longitude&&(n!=null&&n.latitude)&&(l.longitude=n.longitude,l.latitude=n.latitude),await a(l),i.resetFields(),p(null)}catch(l){console.error("表单验证失败:",l)}},u=()=>{i.resetFields(),p(null),r()},s=l=>{p(l),m(!1)};return Bt.useEffect(()=>{if(t&&n){const l={...n,businessStartTime:n.businessStartTime?ee(n.businessStartTime,"HH:mm"):void 0,businessEndTime:n.businessEndTime?ee(n.businessEndTime,"HH:mm"):void 0};i.setFieldsValue(l),n.longitude&&n.latitude&&p({longitude:n.longitude,latitude:n.latitude})}else t&&(i.resetFields(),p(null))},[t,n,i]),f(fe,{children:[e(ne,{title:o,open:t,onCancel:u,onOk:y,okText:"保存",cancelText:"取消",width:600,children:f(v,{form:i,layout:"vertical",initialValues:{minAdvanceHours:2,maxAdvanceDays:30,serviceFee:0},children:[e(v.Item,{label:"门店名称",name:"storeName",rules:[{required:!0,message:"请输入门店名称"},{max:100,message:"门店名称不能超过100个字符"}],children:e(R,{placeholder:"请输入门店名称"})}),e(v.Item,{label:"所在城市",name:"city",rules:[{required:!0,message:"请选择所在城市"},{max:50,message:"城市名称不能超过50个字符"}],children:f(O,{placeholder:"请选择城市",children:[e(O.Option,{value:"北京",children:"北京"}),e(O.Option,{value:"上海",children:"上海"}),e(O.Option,{value:"广州",children:"广州"}),e(O.Option,{value:"深圳",children:"深圳"}),e(O.Option,{value:"杭州",children:"杭州"}),e(O.Option,{value:"南京",children:"南京"}),e(O.Option,{value:"成都",children:"成都"}),e(O.Option,{value:"重庆",children:"重庆"})]})}),e(v.Item,{label:"详细地址",name:"address",rules:[{required:!0,message:"请输入详细地址"},{max:200,message:"地址不能超过200个字符"}],children:e(R.TextArea,{placeholder:"请输入详细地址",rows:3})}),e(v.Item,{label:"门店位置",children:f(W,{direction:"vertical",style:{width:"100%"},children:[h?f("div",{children:[f("p",{children:["经度: ",h.longitude.toFixed(6)]}),f("p",{children:["纬度: ",h.latitude.toFixed(6)]})]}):n!=null&&n.longitude&&(n!=null&&n.latitude)?f("div",{children:[f("p",{children:["经度: ",n.longitude.toFixed(6)]}),f("p",{children:["纬度: ",n.latitude.toFixed(6)]})]}):e("p",{children:"尚未选择位置"}),e(D,{type:"primary",onClick:()=>m(!0),children:h||n!=null&&n.longitude&&(n!=null&&n.latitude)?"重新选择位置":"选择位置"})]})}),e(v.Item,{label:"营业时间",children:f(R.Group,{compact:!0,children:[e(v.Item,{name:"businessStartTime",style:{width:"50%"},rules:[{required:!0,message:"请选择营业开始时间"}],children:e(ht,{placeholder:"开始时间",style:{width:"100%"},format:"HH:mm",showNow:!1})}),e(v.Item,{name:"businessEndTime",style:{width:"50%"},rules:[{required:!0,message:"请选择营业结束时间"}],children:e(ht,{placeholder:"结束时间",style:{width:"100%"},format:"HH:mm",showNow:!1})})]})}),e(v.Item,{label:"最小提前预定时间(小时)",name:"minAdvanceHours",rules:[{required:!0,message:"请输入最小提前预定时间"},{type:"number",min:1,message:"最小提前预定时间不能少于1小时"}],children:e(G,{placeholder:"小时",style:{width:"100%"},min:1})}),e(v.Item,{label:"最大提前预定天数",name:"maxAdvanceDays",rules:[{required:!0,message:"请输入最大提前预定天数"},{type:"number",min:1,max:365,message:"天数必须在1-365之间"}],children:e(G,{placeholder:"天数",style:{width:"100%"},min:1,max:365})}),e(v.Item,{label:"车行手续费(分)",name:"serviceFee",rules:[{required:!0,message:"请输入车行手续费"},{type:"number",min:0,message:"手续费不能为负数"}],children:e(G,{placeholder:"分",style:{width:"100%"},min:0})})]})}),e(Ol,{visible:d,onCancel:()=>m(!1),onConfirm:s,initialLocation:h||(n!=null&&n.longitude&&(n!=null&&n.latitude)?{longitude:n.longitude,latitude:n.latitude}:void 0)})]})},gr=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState(null),d=async()=>{try{n(!0),i(null);const s=await ce.getStores();let l=[];s!=null&&s.data&&(s.data.records&&Array.isArray(s.data.records)?l=s.data.records:Array.isArray(s.data)&&(l=s.data));const g=l.map(S=>({...S,name:S.storeName||S.name||"",status:S.onlineStatus===1?"active":"inactive"}));r(g)}catch(s){const l=s instanceof Error?s.message:"获取门店列表失败";i(l),b.error(l),r([{id:"1",storeName:"总店",name:"总店",city:"上海",address:"上海市浦东新区陆家嘴金融中心",phone:"021-12345678",status:"active",onlineStatus:1},{id:"2",storeName:"虹桥分店",name:"虹桥分店",city:"上海",address:"上海市长宁区虹桥路1号",phone:"021-87654321",status:"active",onlineStatus:1}])}finally{n(!1)}},m=async s=>{try{n(!0),await ce.createStore(s),b.success("门店创建成功"),await d()}catch(l){const g=l instanceof Error?l.message:"创建门店失败";throw b.error(g),l}finally{n(!1)}},h=async(s,l)=>{try{n(!0),await ce.updateStore(s,l),b.success("门店更新成功"),await d()}catch(g){const S=g instanceof Error?g.message:"更新门店失败";throw b.error(S),g}finally{n(!1)}},p=async s=>{try{n(!0),await ce.deleteStore(s),b.success("门店删除成功"),await d()}catch(l){const g=l instanceof Error?l.message:"删除门店失败";throw b.error(g),l}finally{n(!1)}},y=async s=>{try{n(!0),await ce.onlineStore(s),b.success("门店上架成功"),await d()}catch(l){const g=l instanceof Error?l.message:"门店上架失败";throw b.error(g),l}finally{n(!1)}},u=async s=>{try{n(!0),await ce.offlineStore(s),b.success("门店下架成功"),await d()}catch(l){const g=l instanceof Error?l.message:"门店下架失败";throw b.error(g),l}finally{n(!1)}};return c.useEffect(()=>{d()},[]),{stores:t,loading:a,error:o,fetchStores:d,createStore:m,updateStore:h,deleteStore:p,onlineStore:y,offlineStore:u}};const Ml=(t,r)=>{const a=c.useRef(null);return(...n)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{t(...n)},r)}},St=({visible:t,onCancel:r,onFinish:a,initialCoordinates:n})=>{const o=c.useRef(null),i=c.useRef(null),d=c.useRef(null),m=c.useRef(null),[h,p]=c.useState(n||[]),[y,u]=c.useState(!1),s=c.useRef(null),l=T=>{console.log(`[ServiceAreaMapModal] ${T}`)};Ml(T=>{p(T)},100);const g=()=>{try{if(l("开始清理资源"),m.current&&s.current)try{l("清理鼠标工具事件监听器"),m.current.off("draw",s.current)}catch(T){l(`清理鼠标工具事件监听器错误: ${T}`),console.error("清理鼠标工具事件监听器错误:",T)}if(m.current)try{l("关闭鼠标工具"),m.current.close(!0)}catch(T){l(`关闭鼠标工具错误: ${T}`),console.error("关闭鼠标工具错误:",T)}if(d.current){try{l("清理多边形事件监听器"),d.current.off("adjust"),d.current.off("dragstart")}catch(T){l(`清理多边形事件监听器错误: ${T}`),console.error("清理多边形事件监听器错误:",T)}if(i.current)try{l("移除多边形"),i.current.remove(d.current)}catch(T){l(`移除多边形错误: ${T}`),console.error("移除多边形错误:",T)}}m.current=null,d.current=null,i.current=null,s.current=null,l("资源清理完成")}catch(T){l(`组件卸载清理错误: ${T}`),console.error("组件卸载清理错误:",T)}};c.useEffect(()=>(l(`组件Effect触发, visible: ${t}`),t&&o.current&&!i.current&&(l("初始化地图"),P()),t&&i.current&&(l("更新坐标点"),p(n||[]),setTimeout(()=>{$(n||[])},100)),()=>{l("组件卸载，执行清理"),g()}),[t,n]);const S=T=>!T||!Array.isArray(T)?[]:T.filter(C=>{if(!C||!Array.isArray(C)||C.length<2)return!1;const L=typeof C[0]=="number"?C[0]:parseFloat(C[0]),N=typeof C[1]=="number"?C[1]:parseFloat(C[1]);return isNaN(L)||isNaN(N)||Math.abs(L)>180||Math.abs(N)>90?!1:[L,N]}),P=()=>{if(l("开始初始化地图"),!o.current){l("地图容器不存在");return}if(typeof window.AMap>"u"){l("高德地图API未加载"),b.error("地图加载失败，请检查网络连接");return}try{l("创建地图实例");const T=new window.AMap.Map(o.current,{zoom:11,center:[116.397428,39.90923]});if(i.current=T,l("地图实例创建成功"),l("加载鼠标工具插件"),window.AMap.plugin(["AMap.MouseTool"],()=>{try{l("初始化鼠标工具");const C=new window.AMap.MouseTool(T);m.current=C,l("鼠标工具初始化成功");const L=N=>{l("绘制完成事件触发"),C&&s.current&&(l("移除绘制事件监听器"),C.off("draw",s.current)),setTimeout(()=>{try{if(l("处理绘制完成事件"),N.obj&&N.obj.getPath){l("获取路径坐标");const z=N.obj.getPath().map(w=>w&&typeof w=="object"&&w.lng!==void 0&&w.lat!==void 0?[w.lng,w.lat]:null).filter(Boolean);l(`获取到 ${z.length} 个坐标点`);const E=S(z);p(E),l("坐标状态更新完成"),C&&(l("关闭鼠标工具"),C.close(!0)),setTimeout(()=>{l("绘制自定义多边形"),$(E)},10)}}catch(V){l(`绘制完成事件处理错误: ${V}`),console.error("绘制完成事件处理错误:",V),b.error("绘制完成处理时出现错误")}finally{setTimeout(()=>{l("设置绘制状态为完成"),u(!1)},50)}},10)};s.current=L,l("添加绘制事件监听器"),C.on("draw",L)}catch(C){l(`初始化鼠标工具错误: ${C}`),console.error("初始化鼠标工具错误:",C),b.error("地图工具初始化失败")}}),n&&Array.isArray(n)&&n.length>0){l("绘制初始坐标");const C=S(n);setTimeout(()=>{$(C)},100)}}catch(T){l(`初始化地图错误: ${T}`),console.error("初始化地图错误:",T),b.error("地图初始化失败")}},$=T=>{const C=S(T);if(!(!i.current||C.length===0)){if(d.current)try{l("清理多边形事件监听器"),d.current.off("adjust"),d.current.off("dragstart"),i.current.remove(d.current)}catch(L){l(`清理旧多边形错误: ${L}`),console.error("清理旧多边形错误:",L)}try{l("创建新的多边形");const L=new window.AMap.Polygon({path:C.map(z=>new window.AMap.LngLat(z[0],z[1])),strokeColor:"#3366FF",strokeWeight:3,strokeOpacity:.8,fillOpacity:.3,fillColor:"#1791fc",zIndex:50,editable:!0}),N=()=>{try{const E=L.getPath().map(k=>k&&typeof k=="object"&&k.lng!==void 0&&k.lat!==void 0?[k.lng,k.lat]:null).filter(Boolean),w=S(E);p(w)}catch(z){l(`多边形调整事件错误: ${z}`),console.error("多边形调整事件错误:",z)}},V=()=>{try{L.setOptions({fillColor:"#1791fc"})}catch(z){l(`多边形拖拽开始事件错误: ${z}`),console.error("多边形拖拽开始事件错误:",z)}};L.on("adjust",N),L.on("dragstart",V),i.current.add(L),d.current=L,i.current.setFitView([L]),l("多边形创建完成")}catch(L){l(`创建多边形错误: ${L}`),console.error("创建多边形错误:",L),b.error("绘制区域时出现错误，请重试")}}},I=()=>{if(!m.current){b.warning("地图工具尚未初始化完成，请稍后重试");return}try{U(),u(!0),m.current.polygon({strokeColor:"#3366FF",strokeWeight:3,strokeOpacity:.8,fillOpacity:.3,fillColor:"#1791fc"})}catch(T){console.error("开始绘制错误:",T),b.error("开始绘制时出现错误"),u(!1)}},q=()=>{if(h.length<3){b.warning("请至少选择3个点来绘制区域");return}try{a(h)}catch(T){console.error("完成绘制错误:",T),b.error("保存区域时出现错误")}},U=()=>{var T;try{if(p([]),d.current){try{(T=i.current)==null||T.remove(d.current)}catch(C){console.error("移除多边形错误:",C)}d.current=null}if(m.current)try{m.current.close(!0)}catch(C){console.error("关闭鼠标工具错误:",C)}}catch(C){console.error("清除操作错误:",C),b.error("清除操作时出现错误")}};return f(ne,{title:"设置服务范围",visible:t,onCancel:r,onOk:q,width:1e3,footer:[e(D,{onClick:r,children:"取消"},"back"),e(D,{onClick:U,children:"清除"},"clear"),e(D,{type:"primary",onClick:I,loading:y,children:y?"绘制中...":"开始绘制"},"draw"),e(D,{type:"primary",onClick:q,children:"确定"},"submit")],children:[e("div",{className:"map-instructions",children:e("p",{children:'点击"开始绘制"按钮，在地图上绘制服务范围区域，至少需要3个点。绘制完成后可拖拽顶点调整区域。'})}),e("div",{ref:o,style:{width:"100%",height:"500px"},className:"service-area-map"}),f("div",{className:"coordinates-info",children:[f("p",{children:["已选择 ",h.length," 个坐标点"]}),h.length>0&&e("div",{className:"coordinates-list",children:h.map((T,C)=>{if(!T||!Array.isArray(T)||T.length<2||T[0]===void 0||T[1]===void 0)return e("span",{className:"coordinate-item",children:"(无效坐标)"},C);const L=typeof T[0]=="number"?T[0]:parseFloat(T[0]),N=typeof T[1]=="number"?T[1]:parseFloat(T[1]);return isNaN(L)||isNaN(N)?e("span",{className:"coordinate-item",children:"(无效坐标)"},C):f("span",{className:"coordinate-item",children:["(",L.toFixed(6),", ",N.toFixed(6),")"]},C)})})]})]})};const Dl=({storeId:t,storeName:r})=>{const[a]=v.useForm(),[n,o]=c.useState([]),[i,d]=c.useState(!1),[m,h]=c.useState(!1),[p,y]=c.useState(!1),[u,s]=c.useState(null),[l,g]=c.useState([]),S=async()=>{d(!0);try{const C=await He.listByStoreId(Number(t));o(C.data||[])}catch{b.error("获取服务范围列表失败")}finally{d(!1)}};c.useEffect(()=>{t&&S()},[t]);const P=async C=>{try{const L={...u,...C,storeId:Number(t),serviceStartTime:C.serviceTime[0].format("HH:mm"),serviceEndTime:C.serviceTime[1].format("HH:mm"),fenceCoordinates:JSON.stringify(l)};u!=null&&u.id?(await He.update(L),b.success("更新成功")):(await He.create(L),b.success("创建成功")),h(!1),a.resetFields(),s(null),g([]),S()}catch{b.error(u!=null&&u.id?"更新失败":"创建失败")}},$=C=>{if(s(C),a.setFieldsValue({...C,serviceTime:[C.serviceStartTime?ee(C.serviceStartTime,"HH:mm"):null,C.serviceEndTime?ee(C.serviceEndTime,"HH:mm"):null]}),C.fenceCoordinates)try{const L=JSON.parse(C.fenceCoordinates);g(L)}catch{g([])}h(!0)},I=C=>{ne.confirm({title:"确认删除",content:"确定要删除这个服务范围吗？",onOk:async()=>{try{await He.delete(C),b.success("删除成功"),S()}catch{b.error("删除失败")}}})},q=()=>{y(!0)},U=C=>{g(C),y(!1)},T=[{title:"区域名称",dataIndex:"areaName",key:"areaName"},{title:"区域类型",dataIndex:"areaType",key:"areaType",render:C=>C===1?"取车区域":"还车区域"},{title:"服务时间",key:"serviceTime",render:(C,L)=>f("span",{children:[L.serviceStartTime," - ",L.serviceEndTime]})},{title:"提前预定时间",dataIndex:"advanceHours",key:"advanceHours",render:C=>`${C}小时`},{title:"送车上门",dataIndex:"doorToDoorDelivery",key:"doorToDoorDelivery",render:C=>C===1?"是":"否"},{title:"操作",key:"action",render:(C,L)=>f(W,{size:"middle",children:[e(D,{type:"primary",icon:e(pe,{}),onClick:()=>$(L),size:"small",children:"编辑"}),e(D,{danger:!0,icon:e(Ye,{}),onClick:()=>I(L.id),size:"small",children:"删除"})]})}];return f("div",{className:"store-service-area-management",children:[e(B,{title:`[${r}] 服务范围管理`,extra:e(D,{type:"primary",icon:e(Ee,{}),onClick:()=>{s(null),a.resetFields(),g([]),h(!0)},children:"新增服务范围"}),children:e(le,{dataSource:n,columns:T,loading:i,rowKey:"id",pagination:{pageSize:10}})}),e(ne,{title:u!=null&&u.id?"编辑服务范围":"新增服务范围",visible:m,onCancel:()=>{h(!1),a.resetFields(),s(null),g([])},onOk:()=>a.submit(),width:800,children:f(v,{form:a,layout:"vertical",onFinish:P,children:[f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"areaName",label:"区域名称",rules:[{required:!0,message:"请输入区域名称"}],children:e(R,{placeholder:"请输入区域名称"})})}),e(A,{span:12,children:e(v.Item,{name:"areaType",label:"区域类型",rules:[{required:!0,message:"请选择区域类型"}],children:f(se.Group,{children:[e(se,{value:1,children:"取车区域"}),e(se,{value:2,children:"还车区域"})]})})})]}),f(v.Item,{label:"电子围栏",required:!0,children:[e(D,{onClick:q,children:l.length>0?"已设置电子围栏":"设置电子围栏"}),l.length>0&&f("div",{style:{marginTop:8},children:["已选择 ",l.length," 个坐标点"]})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"advanceHours",label:"提前预定时间(小时)",rules:[{required:!0,message:"请输入提前预定时间"}],children:e(G,{min:0,style:{width:"100%"},placeholder:"请输入提前预定时间"})})}),e(A,{span:12,children:e(v.Item,{name:"serviceTime",label:"服务时间",rules:[{required:!0,message:"请选择服务时间"}],children:e(ht.RangePicker,{style:{width:"100%"},format:"HH:mm"})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"doorToDoorDelivery",label:"是否提供送车上门",rules:[{required:!0,message:"请选择是否提供送车上门"}],children:f(se.Group,{children:[e(se,{value:1,children:"是"}),e(se,{value:0,children:"否"})]})})}),e(A,{span:12,children:e(v.Item,{name:"deliveryFee",label:"送车上门费用(元)",rules:[{required:!0,message:"请输入送车上门费用"}],children:e(G,{min:0,style:{width:"100%"},placeholder:"请输入送车上门费用",formatter:C=>`${C}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:C=>C?parseFloat(C.replace(/,*/g,"")):0})})})]}),e(v.Item,{name:"freePickupToStore",label:"是否免费接至门店",rules:[{required:!0,message:"请选择是否免费接至门店"}],children:f(se.Group,{children:[e(se,{value:1,children:"是"}),e(se,{value:0,children:"否"})]})})]})}),e(St,{visible:p,onCancel:()=>y(!1),onFinish:U,initialCoordinates:l})]})},$l=()=>{const{stores:t,loading:r,deleteStore:a,createStore:n,updateStore:o,onlineStore:i,offlineStore:d}=gr(),[m,h]=c.useState(!1),[p,y]=c.useState(void 0),[u,s]=c.useState(void 0),l=Array.isArray(t)?t:[],g=async w=>{try{await a(w)}catch{}},S=()=>{y(void 0),h(!0)},P=w=>{y(w),h(!0)},$=w=>{s(w)},I=async w=>{try{await i(w)}catch{}},q=async w=>{try{await d(w)}catch{}},U=()=>{s(void 0)},T=async w=>{try{p?(await o(p.id,w),b.success("门店更新成功")):(await n(w),b.success("门店创建成功")),h(!1),y(void 0)}catch{}},C=()=>{h(!1),y(void 0)},L=l.filter(w=>w.onlineStatus===1||w.status==="active").length,N=l.filter(w=>w.onlineStatus===0||w.status==="inactive").length,V=128e3,z=[{title:"门店名称",dataIndex:"storeName",key:"storeName",render:(w,k)=>k.storeName||k.name||w},{title:"城市",dataIndex:"city",key:"city"},{title:"门店地址",dataIndex:"address",key:"address"},{title:"联系电话",dataIndex:"phone",key:"phone",render:w=>w||"暂无"},{title:"状态",dataIndex:"status",key:"status",render:(w,k)=>{const _=k.onlineStatus===1||w==="active",ie=k.onlineStatusDesc||(_?"上架":"下架");return e(ge,{color:_?"green":"red",children:ie})}},{title:"操作",key:"action",render:(w,k)=>f(W,{size:"middle",children:[e(D,{type:"link",icon:e(pe,{}),onClick:()=>P(k),children:"编辑"}),k.onlineStatus===1?e(Oe,{title:"下架门店",description:"确定要下架这个门店吗？",onConfirm:()=>q(k.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",icon:e(Dr,{}),children:"下架"})}):e(Oe,{title:"上架门店",description:"确定要上架这个门店吗？",onConfirm:()=>I(k.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",icon:e($r,{}),children:"上架"})}),e(D,{type:"link",onClick:()=>$(k),children:"服务范围管理"}),e(Oe,{title:"删除门店",description:"确定要删除这个门店吗？",onConfirm:()=>g(k.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",danger:!0,icon:e(Ye,{}),children:"删除"})})]})}],E=l;return u?f(ye,{title:"门店管理",children:[e(D,{onClick:U,style:{marginBottom:16},children:"← 返回门店列表"}),e(Dl,{storeId:u.id,storeName:u.storeName||u.name||""})]}):e(ye,{title:"门店管理",children:f(Se,{spinning:r,children:[f(J,{gutter:16,style:{marginBottom:24},children:[e(A,{span:6,children:e(B,{children:e(he,{title:"门店总数",value:l.length})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"上架门店",value:L})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"下架门店",value:N})})}),e(A,{span:6,children:e(B,{children:e(he,{title:"月营业额",value:V,prefix:"¥"})})})]}),e(B,{title:"门店列表",extra:e(D,{type:"primary",icon:e(Ee,{}),onClick:S,children:"新增门店"}),children:e(le,{columns:z,dataSource:E.map(w=>({...w,key:w.id})),loading:r})}),e(El,{visible:m,onCancel:C,onSubmit:T,initialValues:p,title:p?"编辑门店":"新增门店"})]})})},Rl=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState(null),d=async()=>{n(!0),i(null);try{const m=await fr.getAllCarModels();if(m.success)r(m.data||[]);else throw new Error(m.message||"获取车型数据失败")}catch(m){const h=m instanceof Error?m.message:"获取车型数据失败";i(h),b.error(h),r([])}finally{n(!1)}};return c.useEffect(()=>{d()},[]),{carModels:t,loading:a,error:o,refetch:d}},Nl=({visible:t,onCancel:r,onSubmit:a,initialValues:n,title:o})=>{const[i]=v.useForm(),{stores:d}=gr(),{carModels:m,loading:h}=Rl(),p=Array.isArray(d)?d.map(l=>({label:l.storeName||l.name||"",value:l.id})):[],y=Array.isArray(m)?m.map(l=>({label:`${l.brand}${l.series} - ${l.model}`,value:l.id})):[],u=async()=>{try{const l=await i.validateFields();l.registerDate&&(l.registerDate=l.registerDate.format("YYYY-MM-DD")),await a(l),i.resetFields()}catch(l){console.error("表单验证失败:",l)}},s=()=>{i.resetFields(),r()};return c.useEffect(()=>{if(t&&n){const l={...n,registerDate:n.registerDate?ee(n.registerDate):void 0};i.setFieldsValue(l)}else t&&i.resetFields()},[t,n,i]),e(ne,{title:o,open:t,onCancel:s,onOk:u,okText:"保存",cancelText:"取消",width:600,children:f(v,{form:i,layout:"vertical",initialValues:{licenseType:1,usageNature:1,mileage:0},children:[e(v.Item,{label:"归属门店",name:"storeId",rules:[{required:!0,message:"请选择归属门店"}],children:e(O,{placeholder:"请选择门店",options:p})}),e(v.Item,{label:"车牌号",name:"licensePlate",rules:[{required:!0,message:"请输入车牌号"},{pattern:/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-Z][A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]$/,message:"车牌号格式不正确"}],children:e(R,{placeholder:"请输入车牌号，如：京A12345"})}),e(v.Item,{label:"车型ID",name:"carModelId",rules:[{required:!0,message:"请选择车型"}],children:e(O,{placeholder:"请选择车型",loading:h,options:y,showSearch:!0,filterOption:(l,g)=>{var S;return((S=g==null?void 0:g.label)==null?void 0:S.toLowerCase().includes(l.toLowerCase()))||!1}})}),e(v.Item,{label:"牌照类型",name:"licenseType",rules:[{required:!0,message:"请选择牌照类型"}],children:f(O,{placeholder:"请选择牌照类型",children:[e(O.Option,{value:1,children:"普通"}),e(O.Option,{value:2,children:"京牌"}),e(O.Option,{value:3,children:"沪牌"}),e(O.Option,{value:4,children:"深牌"}),e(O.Option,{value:5,children:"粤A牌"}),e(O.Option,{value:6,children:"杭州牌"})]})}),e(v.Item,{label:"注册日期",name:"registerDate",rules:[{required:!0,message:"请选择注册日期"}],children:e(Rr,{placeholder:"请选择注册日期",style:{width:"100%"},disabledDate:l=>l&&l>ee()})}),e(v.Item,{label:"车架号",name:"vin",rules:[{required:!0,message:"请输入车架号"},{pattern:/^[A-HJ-NPR-Z\d]{17}$/,message:"车架号格式不正确，应为17位字符"}],children:e(R,{placeholder:"请输入17位车架号",maxLength:17})}),e(v.Item,{label:"发动机号",name:"engineNo",rules:[{required:!0,message:"请输入发动机号"},{max:50,message:"发动机号不能超过50个字符"}],children:e(R,{placeholder:"请输入发动机号"})}),e(v.Item,{label:"使用性质",name:"usageNature",rules:[{required:!0,message:"请选择使用性质"}],children:f(O,{placeholder:"请选择使用性质",children:[e(O.Option,{value:1,children:"营运"}),e(O.Option,{value:2,children:"非营运"})]})}),e(v.Item,{label:"总里程(公里)",name:"mileage",rules:[{type:"number",min:0,message:"总里程不能为负数"}],children:e(G,{placeholder:"请输入总里程",style:{width:"100%"},min:0,addonAfter:"公里"})})]})})},Al=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState(null),d=u=>u.map(s=>{var l,g;return{id:String(s.id||""),storeId:s.storeId,storeName:s.storeName,licensePlate:s.licensePlate||"",carModelId:s.carModelId,carModel:s.carModel,licenseType:s.licenseType,licenseTypeDesc:s.licenseTypeDesc,registerDate:s.registerDate,vin:s.vin,engineNo:s.engineNo,usageNature:s.usageNature,usageNatureDesc:s.usageNatureDesc,auditStatus:s.auditStatus,auditStatusDesc:s.auditStatusDesc,onlineStatus:s.onlineStatus,onlineStatusDesc:s.onlineStatusDesc,vehicleStatus:s.vehicleStatus,vehicleStatusDesc:s.vehicleStatusDesc,mileage:s.mileage,createdTime:s.createdTime,updatedTime:s.updatedTime,plateNumber:s.licensePlate||"",model:((l=s.carModel)==null?void 0:l.model)||"未知车型",brand:((g=s.carModel)==null?void 0:g.brand)||"未知品牌",color:"白色",status:(()=>{switch(s.vehicleStatus){case 1:return"available";case 2:return"rented";case 3:return"maintenance";case 4:return"inactive";default:return"available"}})(),dailyRate:150}}),m=async()=>{try{n(!0),i(null);const u=await Ae.getVehicles();console.log("车辆API返回数据:",u);let s=[];if(u!=null&&u.data&&(u.data.records&&Array.isArray(u.data.records)?s=u.data.records:Array.isArray(u.data)&&(s=u.data)),console.log("解析后的车辆数据:",s),s.length>0){const l=d(s);console.log("转换后的车辆数据:",l),r(l)}else console.warn("车辆数据为空，使用Mock数据"),r([{id:"1",licensePlate:"沪A12345",plateNumber:"沪A12345",model:"朗逸",brand:"大众",color:"白色",status:"available",dailyRate:150},{id:"2",licensePlate:"沪B67890",plateNumber:"沪B67890",model:"轩逸",brand:"日产",color:"银色",status:"rented",dailyRate:140},{id:"3",licensePlate:"沪C11111",plateNumber:"沪C11111",model:"Model 3",brand:"特斯拉",color:"黑色",status:"maintenance",dailyRate:300}])}catch(u){const s=u instanceof Error?u.message:"获取车辆列表失败";i(s),b.error(s),r([{id:"1",licensePlate:"沪A12345",plateNumber:"沪A12345",model:"朗逸",brand:"大众",color:"白色",status:"available",dailyRate:150},{id:"2",licensePlate:"沪B67890",plateNumber:"沪B67890",model:"轩逸",brand:"日产",color:"银色",status:"rented",dailyRate:140},{id:"3",licensePlate:"沪C11111",plateNumber:"沪C11111",model:"Model 3",brand:"特斯拉",color:"黑色",status:"maintenance",dailyRate:300}])}finally{n(!1)}},h=async u=>{try{n(!0),await Ae.createVehicle(u),b.success("车辆创建成功"),await m()}catch(s){const l=s instanceof Error?s.message:"创建车辆失败";throw b.error(l),s}finally{n(!1)}},p=async(u,s)=>{try{n(!0),await Ae.updateVehicle(u,s),b.success("车辆更新成功"),await m()}catch(l){const g=l instanceof Error?l.message:"更新车辆失败";throw b.error(g),l}finally{n(!1)}},y=async u=>{try{n(!0),await Ae.deleteVehicle(u),b.success("车辆删除成功"),await m()}catch(s){const l=s instanceof Error?s.message:"删除车辆失败";throw b.error(l),s}finally{n(!1)}};return c.useEffect(()=>{m()},[]),{vehicles:t,loading:a,error:o,fetchVehicles:m,createVehicle:h,updateVehicle:p,deleteVehicle:y}},{Search:Ll}=R,zl=()=>{const{vehicles:t,loading:r,deleteVehicle:a,createVehicle:n,updateVehicle:o}=Al(),[i,d]=c.useState(!1),[m,h]=c.useState(void 0),p=Array.isArray(t)?t:[],y=async $=>{try{await a($)}catch{}},u=()=>{h(void 0),d(!0)},s=$=>{h($),d(!0)},l=async $=>{try{m?(await o(m.id,$),b.success("车辆更新成功")):(await n($),b.success("车辆创建成功")),d(!1),h(void 0)}catch{}},g=()=>{d(!1),h(void 0)},S=[{title:"车牌号",dataIndex:"plateNumber",key:"plateNumber"},{title:"车型",dataIndex:"model",key:"model"},{title:"品牌",dataIndex:"brand",key:"brand"},{title:"颜色",dataIndex:"color",key:"color"},{title:"状态",dataIndex:"status",key:"status",render:$=>{const q={available:{color:"green",text:"可租用"},rented:{color:"blue",text:"已租出"},maintenance:{color:"orange",text:"维护中"},inactive:{color:"red",text:"停用"}}[$];return e(ge,{color:q.color,children:q.text})}},{title:"日租金",dataIndex:"dailyRate",key:"dailyRate",render:$=>`¥${$}`},{title:"操作",key:"action",render:($,I)=>f(W,{size:"middle",children:[e(D,{type:"link",icon:e(pe,{}),onClick:()=>s(I),children:"编辑"}),e(Oe,{title:"删除车辆",description:"确定要删除这辆车吗？",onConfirm:()=>y(I.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",danger:!0,icon:e(Ye,{}),children:"删除"})})]})}],P=p;return e(ye,{title:"车辆管理",children:f(Se,{spinning:r,children:[e(B,{title:"车辆列表",extra:f(W,{children:[e(Ll,{placeholder:"搜索车牌号",style:{width:200}}),f(O,{defaultValue:"all",style:{width:120},children:[e(O.Option,{value:"all",children:"全部状态"}),e(O.Option,{value:"available",children:"可租用"}),e(O.Option,{value:"rented",children:"已租出"}),e(O.Option,{value:"maintenance",children:"维护中"})]}),e(D,{type:"primary",icon:e(Ee,{}),onClick:u,children:"新增车辆"})]}),children:e(le,{columns:S,dataSource:P.map($=>({...$,key:$.id})),loading:r})}),e(Nl,{visible:i,onCancel:g,onSubmit:l,initialValues:m,title:m?"编辑车辆":"新增车辆"})]})})},Fl=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState(null),d=async s=>{var l;try{n(!0),i(null);const g=await Te.getOrders(s),S=Array.isArray((l=g==null?void 0:g.data)==null?void 0:l.records)?g.data.records:[];r(S)}catch(g){const S=g instanceof Error?g.message:"获取订单列表失败";i(S),b.error(S)}finally{n(!1)}};return{orders:t,loading:a,error:o,fetchOrders:d,getOrderDetail:async s=>{try{return n(!0),(await Te.getOrderDetail(s)).data}catch(l){const g=l instanceof Error?l.message:"获取订单详情失败";throw b.error(g),l}finally{n(!1)}},assignPickupDriver:async(s,l)=>{try{n(!0),await Te.assignPickupDriver(s,l),b.success("分配取车司机成功"),await d()}catch(g){const S=g instanceof Error?g.message:"分配取车司机失败";throw b.error(S),g}finally{n(!1)}},assignReturnDriver:async(s,l)=>{try{n(!0),await Te.assignReturnDriver(s,l),b.success("分配还车司机成功"),await d()}catch(g){const S=g instanceof Error?g.message:"分配还车司机失败";throw b.error(S),g}finally{n(!1)}},confirmPickup:async s=>{try{n(!0),await Te.confirmPickup(s),b.success("确认取车成功"),await d()}catch(l){const g=l instanceof Error?l.message:"确认取车失败";throw b.error(g),l}finally{n(!1)}},confirmReturn:async s=>{try{n(!0),await Te.confirmReturn(s),b.success("确认还车成功"),await d()}catch(l){const g=l instanceof Error?l.message:"确认还车失败";throw b.error(g),l}finally{n(!1)}}}},{Search:_l}=R,Vl=()=>{const{orders:t,loading:r,fetchOrders:a,getOrderDetail:n,assignPickupDriver:o,assignReturnDriver:i,confirmPickup:d,confirmReturn:m}=Fl(),[h]=v.useForm(),[p,y]=c.useState(null),[u,s]=c.useState(!1),[l,g]=c.useState(!1),[S,P]=c.useState({current:1,size:10,orderNo:"",status:void 0}),$=Array.isArray(t)?t:[];c.useEffect(()=>{a(S)},[S]);const I=w=>{P(k=>({...k,orderNo:w,current:1}))},q=w=>{P(k=>({...k,status:w==="all"?void 0:Number(w),current:1}))},U=w=>{P(k=>({...k,current:w.current,size:w.pageSize}))},T=(w,k)=>{y(w),h.setFieldsValue({driverName:k==="pickup"?w.pickupDriver:w.returnDriver}),s(!0)},C=async w=>{try{const k=await n(w.id);y(k),g(!0)}catch(k){console.error("获取订单详情失败:",k)}},L=async w=>{if(p)try{p.orderStatus===2?await o(p.id,w.driverName):p.orderStatus===3&&await i(p.id,w.driverName),s(!1),h.resetFields()}catch(k){console.error("分配司机失败:",k)}},N=async w=>{try{await d(w.id),b.success("确认取车成功")}catch(k){console.error("确认取车失败:",k),b.error("确认取车失败")}},V=async w=>{try{await m(w.id),b.success("确认还车成功")}catch(k){console.error("确认还车失败:",k),b.error("确认还车失败")}},z=w=>({1:{text:"待支付",color:"orange"},2:{text:"待取车",color:"blue"},3:{text:"已取车",color:"green"},4:{text:"已完成",color:"gray"},5:{text:"已取消",color:"red"}})[w]||{text:"未知",color:"default"},E=[{title:"订单号",dataIndex:"orderNo",key:"orderNo"},{title:"客户姓名",dataIndex:"driverName",key:"driverName"},{title:"车辆信息",dataIndex:"licensePlate",key:"licensePlate",render:(w,k)=>f(W,{children:[e(pr,{}),e("span",{children:w||"未分配"})]})},{title:"租期",key:"duration",render:(w,k)=>f("div",{children:[e("div",{children:new Date(k.startTime).toLocaleDateString()}),e("div",{children:"至"}),e("div",{children:new Date(k.endTime).toLocaleDateString()})]})},{title:"取车司机",dataIndex:"pickupDriver",key:"pickupDriver",render:w=>w||"未分配"},{title:"还车司机",dataIndex:"returnDriver",key:"returnDriver",render:w=>w||"未分配"},{title:"订单状态",dataIndex:"orderStatus",key:"orderStatus",render:w=>{const k=z(w);return e(ge,{color:k.color,children:k.text})}},{title:"操作",key:"action",render:(w,k)=>f(W,{size:"middle",children:[e(D,{type:"link",icon:e(Nr,{}),onClick:()=>C(k),children:"查看"}),k.orderStatus===2&&f(fe,{children:[e(D,{type:"link",icon:e(Fe,{}),onClick:()=>T(k,"pickup"),children:"分配司机"}),e(D,{type:"link",icon:e(yt,{}),onClick:()=>N(k),children:"确认取车"})]}),k.orderStatus===3&&f(fe,{children:[e(D,{type:"link",icon:e(Fe,{}),onClick:()=>T(k,"return"),children:"分配司机"}),e(D,{type:"link",icon:e(yt,{}),onClick:()=>V(k),children:"确认还车"})]})]})}];return f(ye,{title:"订单管理",children:[e(Se,{spinning:r,children:e(B,{title:"订单列表",extra:f(W,{children:[e(_l,{placeholder:"搜索订单号",onSearch:I,style:{width:200}}),f(O,{defaultValue:"all",style:{width:120},onChange:q,children:[e(O.Option,{value:"all",children:"全部状态"}),e(O.Option,{value:1,children:"待支付"}),e(O.Option,{value:2,children:"待取车"}),e(O.Option,{value:3,children:"已取车"}),e(O.Option,{value:4,children:"已完成"}),e(O.Option,{value:5,children:"已取消"})]})]}),children:e(le,{columns:E,dataSource:$.map(w=>({...w,key:w.id})),loading:r,pagination:{current:S.current,pageSize:S.size,total:$.length,showSizeChanger:!0,showQuickJumper:!0},onChange:U})})}),e(ne,{title:(p==null?void 0:p.orderStatus)===2?"分配取车司机":"分配还车司机",visible:u,onCancel:()=>{s(!1),h.resetFields()},onOk:()=>h.submit(),children:e(v,{form:h,onFinish:L,children:e(v.Item,{label:"司机姓名",name:"driverName",rules:[{required:!0,message:"请输入司机姓名"}],children:e(R,{placeholder:"请输入司机姓名"})})})}),e(ne,{title:"订单详情",visible:l,onCancel:()=>g(!1),footer:null,width:800,children:p&&f("div",{children:[f(Q,{title:"基本信息",column:2,bordered:!0,children:[e(Q.Item,{label:"订单号",children:p.orderNo}),e(Q.Item,{label:"订单状态",children:e(ge,{color:z(p.orderStatus).color,children:z(p.orderStatus).text})}),e(Q.Item,{label:"客户姓名",children:p.driverName}),e(Q.Item,{label:"联系电话",children:p.driverPhone}),e(Q.Item,{label:"车牌号",children:p.licensePlate||"未分配"}),e(Q.Item,{label:"下单时间",children:p.createdAt?new Date(p.createdAt).toLocaleString():""})]}),e(mt,{}),f(Q,{title:"租期信息",column:2,bordered:!0,children:[e(Q.Item,{label:"计划取车时间",children:new Date(p.startTime).toLocaleString()}),e(Q.Item,{label:"计划还车时间",children:new Date(p.endTime).toLocaleString()}),e(Q.Item,{label:"实际取车时间",children:p.actualPickupTime?new Date(p.actualPickupTime).toLocaleString():"未取车"}),e(Q.Item,{label:"实际还车时间",children:p.actualReturnTime?new Date(p.actualReturnTime).toLocaleString():"未还车"})]}),e(mt,{}),f(Q,{title:"司机信息",column:2,bordered:!0,children:[e(Q.Item,{label:"取车司机",children:p.pickupDriver||"未分配"}),e(Q.Item,{label:"还车司机",children:p.returnDriver||"未分配"})]})]})})]})};const{Title:ql,Paragraph:si}=we,{TextArea:Ft}=R,{Step:Bl}=Ut,Ul=()=>{const[t,r]=c.useState(0),[a]=v.useForm(),[n,o]=c.useState(!1),i=Ue(),d=[{title:"基本信息",description:"填写企业基本信息"},{title:"详细资料",description:"完善企业详细资料"},{title:"联系信息",description:"设置联系人信息"},{title:"账户设置",description:"创建平台账户"}],m=async u=>{if(u.password!==u.confirmPassword){b.error("两次输入的密码不一致");return}o(!0);const s={companyName:u.companyName,unifiedSocialCreditCode:u.businessLicense,legalPersonName:u.legalPerson,legalPersonIdCard:u.legalPersonIdCard,contactName:u.contactPersonName,contactPhone:u.contactPersonPhone,companyAddress:u.businessAddress,businessLicenseUrl:u.businessLicenseUrl||"",transportLicenseUrl:u.transportLicenseUrl||""};try{const l=await M("/merchants/apply",{method:"POST",body:JSON.stringify(s)});l.code===200?(b.success("商户入住申请提交成功！我们将在1-3个工作日内完成审核"),i("/register-success",{state:{merchantId:l.data.merchantId}})):b.error(l.message||"提交失败，请重试")}catch(l){console.error("商户注册失败:",l),b.error("网络错误，请稍后重试")}finally{o(!1)}},h=[["companyName","businessLicense","legalPerson","legalPersonIdCard","contactPhone","contactEmail"],["businessAddress","businessScope","registeredCapital","establishedDate"],["contactPersonName","contactPersonPhone","contactPersonEmail"],["username","password","confirmPassword"]],p=async()=>{try{const u=h[t];await a.validateFields(u),r(t+1)}catch(u){console.log("验证失败:",u)}},y=()=>{r(t-1)};return e("div",{className:"merchant-register-container",children:f(B,{className:"register-form-card",children:[e(ql,{level:2,style:{textAlign:"center",marginBottom:32},children:"商户入住申请"}),e(Ut,{current:t,style:{marginBottom:32},children:d.map(u=>e(Bl,{title:u.title,description:u.description},u.title))}),f(v,{form:a,layout:"vertical",onFinish:m,style:{maxWidth:600,margin:"0 auto"},children:[f("div",{style:{display:t===0?"block":"none"},children:[e(v.Item,{label:"企业名称",name:"companyName",rules:[{required:!0,message:"请输入企业名称"}],children:e(R,{placeholder:"请输入企业全称"})}),e(v.Item,{label:"统一社会信用代码",name:"businessLicense",rules:[{required:!0,message:"请输入统一社会信用代码"},{pattern:/^[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}$/,message:"请输入正确的统一社会信用代码"}],children:e(R,{placeholder:"请输入18位统一社会信用代码"})}),e(v.Item,{label:"法定代表人",name:"legalPerson",rules:[{required:!0,message:"请输入法定代表人姓名"}],children:e(R,{placeholder:"请输入法定代表人姓名"})}),e(v.Item,{label:"法人身份证号",name:"legalPersonIdCard",rules:[{required:!0,message:"请输入法人身份证号"},{pattern:/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,message:"请输入正确的身份证号"}],children:e(R,{placeholder:"请输入法人身份证号"})}),e(v.Item,{label:"企业联系电话",name:"contactPhone",rules:[{required:!0,message:"请输入联系电话"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码"}],children:e(R,{placeholder:"请输入11位手机号码"})}),e(v.Item,{label:"企业邮箱",name:"contactEmail",rules:[{required:!0,message:"请输入企业邮箱"},{type:"email",message:"请输入正确的邮箱地址"}],children:e(R,{placeholder:"请输入企业邮箱地址"})})]}),f("div",{style:{display:t===1?"block":"none"},children:[e(v.Item,{label:"经营地址",name:"businessAddress",rules:[{required:!0,message:"请输入经营地址"}],children:e(Ft,{rows:3,placeholder:"请输入详细的经营地址"})}),e(v.Item,{label:"经营范围",name:"businessScope",rules:[{required:!0,message:"请输入经营范围"}],children:e(Ft,{rows:3,placeholder:"请输入主要经营范围"})}),e(v.Item,{label:"注册资本",name:"registeredCapital",rules:[{required:!0,message:"请输入注册资本"}],children:e(R,{placeholder:"请输入注册资本（万元）",suffix:"万元"})}),e(v.Item,{label:"成立日期",name:"establishedDate",rules:[{required:!0,message:"请选择成立日期"}],children:e(R,{type:"date"})})]}),f("div",{style:{display:t===2?"block":"none"},children:[e(v.Item,{label:"联系人姓名",name:"contactPersonName",rules:[{required:!0,message:"请输入联系人姓名"}],children:e(R,{placeholder:"请输入主要联系人姓名"})}),e(v.Item,{label:"联系人电话",name:"contactPersonPhone",rules:[{required:!0,message:"请输入联系人电话"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码"}],children:e(R,{placeholder:"请输入联系人手机号"})}),e(v.Item,{label:"联系人邮箱",name:"contactPersonEmail",rules:[{required:!0,message:"请输入联系人邮箱"},{type:"email",message:"请输入正确的邮箱地址"}],children:e(R,{placeholder:"请输入联系人邮箱"})})]}),f("div",{style:{display:t===3?"block":"none"},children:[e(v.Item,{label:"登录用户名",name:"username",rules:[{required:!0,message:"请输入用户名"},{min:4,max:20,message:"用户名长度为4-20个字符"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线"}],children:e(R,{placeholder:"请输入登录用户名"})}),e(v.Item,{label:"登录密码",name:"password",rules:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6个字符"},{pattern:/^(?=.*[a-zA-Z])(?=.*\d)/,message:"密码必须包含字母和数字"}],children:e(R.Password,{placeholder:"请输入登录密码"})}),e(v.Item,{label:"确认密码",name:"confirmPassword",rules:[{required:!0,message:"请确认密码"},({getFieldValue:u})=>({validator(s,l){return!l||u("password")===l?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致"))}})],children:e(R.Password,{placeholder:"请再次输入密码"})})]}),e(v.Item,{style:{marginTop:32},children:f(J,{gutter:16,children:[e(A,{span:12,children:t>0&&e(D,{onClick:y,style:{width:"100%"},children:"上一步"})}),e(A,{span:12,children:t<d.length-1?e(D,{type:"primary",onClick:p,style:{width:"100%"},children:"下一步"}):e(D,{type:"primary",htmlType:"submit",loading:n,style:{width:"100%"},children:"提交申请"})})]})})]}),e("div",{style:{textAlign:"center",marginTop:24},children:e(D,{type:"link",onClick:()=>i("/login"),children:"已有账号？立即登录"})})]})})},{Title:_t,Paragraph:ci}=we,jl=()=>{var n;const t=Ue(),a=((n=ke().state)==null?void 0:n.merchantId)||"待分配";return e("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:f(B,{style:{width:"100%",maxWidth:600,borderRadius:12,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},children:[e(Ar,{status:"success",title:"入住申请提交成功！",subTitle:`您的商户申请ID：${a}`,extra:[e(D,{type:"primary",onClick:()=>t("/login"),children:"返回登录"},"login"),e(D,{onClick:()=>t("/"),children:"返回首页"},"home")]}),f("div",{style:{marginTop:24},children:[e(_t,{level:4,children:"后续流程："}),f($e,{children:[f($e.Item,{dot:e(yt,{style:{color:"#52c41a"}}),children:[e("strong",{children:"提交申请"}),e("br",{}),e("span",{style:{color:"#666"},children:"您已成功提交商户入住申请"})]}),f($e.Item,{dot:e(it,{style:{color:"#1890ff"}}),children:[e("strong",{children:"资质审核"}),e("br",{}),e("span",{style:{color:"#666"},children:"我们将在1-3个工作日内完成审核"})]}),f($e.Item,{dot:e(it,{style:{color:"#faad14"}}),children:[e("strong",{children:"账户激活"}),e("br",{}),e("span",{style:{color:"#666"},children:"审核通过后将通过邮件通知您激活账户"})]}),f($e.Item,{dot:e(it,{style:{color:"#722ed1"}}),children:[e("strong",{children:"开始使用"}),e("br",{}),e("span",{style:{color:"#666"},children:"激活后即可登录系统开始使用"})]})]})]}),f("div",{style:{marginTop:32,padding:16,background:"#f6f8fa",borderRadius:8},children:[e(_t,{level:5,style:{margin:0,marginBottom:8},children:"温馨提示："}),f("ul",{style:{margin:0,paddingLeft:20},children:[e("li",{children:"请保持联系电话和邮箱畅通，我们会及时与您联系"}),e("li",{children:"如有疑问，请联系客服：400-xxx-xxxx"}),e("li",{children:"您可以通过邮件查看审核进度"})]})]})]})})},{Title:ct,Paragraph:Vt,Text:dt}=we,Hl=()=>{const[t,r]=c.useState(null),[a,n]=c.useState(null),[o,i]=c.useState(""),[d,m]=c.useState(""),[h,p]=c.useState([]),y=async()=>{var l;try{console.log("正在调用门店API...");const g=await ce.getStores();console.log("门店API响应:",g),r(g),i("");let S=[];(l=g==null?void 0:g.data)!=null&&l.records&&Array.isArray(g.data.records)&&(S=g.data.records,console.log("解析的门店数据:",S),p(S))}catch(g){console.error("门店API错误:",g),i(g instanceof Error?g.message:"未知错误")}},u=async()=>{try{console.log("正在调用车辆API...");const l=await Ae.getVehicles();console.log("车辆API响应:",l),n(l),m("")}catch(l){console.error("车辆API错误:",l),m(l instanceof Error?l.message:"未知错误")}};c.useEffect(()=>{y(),u()},[]);const s=[{title:"ID",dataIndex:"id",key:"id"},{title:"门店名称",dataIndex:"storeName",key:"storeName"},{title:"城市",dataIndex:"city",key:"city"},{title:"地址",dataIndex:"address",key:"address"},{title:"上架状态",dataIndex:"onlineStatus",key:"onlineStatus"}];return f("div",{style:{padding:"24px"},children:[e(ct,{level:2,children:"API调试页面"}),f(W,{direction:"vertical",size:"large",style:{width:"100%"},children:[e(B,{title:"门店API测试",children:f(W,{direction:"vertical",style:{width:"100%"},children:[e(D,{onClick:y,children:"重新测试门店API"}),o&&f(dt,{type:"danger",children:["错误: ",o]}),e(ct,{level:4,children:"原始响应数据:"}),e(Vt,{children:e("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px"},children:t?JSON.stringify(t,null,2):"无数据"})}),h.length>0&&f(fe,{children:[e(ct,{level:4,children:"解析后的门店列表:"}),e(le,{columns:s,dataSource:h.map(l=>({...l,key:l.id})),size:"small"})]})]})}),e(B,{title:"车辆API测试",children:f(W,{direction:"vertical",style:{width:"100%"},children:[e(D,{onClick:u,children:"重新测试车辆API"}),d&&f(dt,{type:"danger",children:["错误: ",d]}),f(Vt,{children:[e(dt,{strong:!0,children:"响应数据:"}),e("pre",{style:{background:"#f5f5f5",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"300px"},children:a?JSON.stringify(a,null,2):"无数据"})]})]})})]})]})},Jl=()=>{const[t,r]=c.useState(!1),[a,n]=c.useState([]),o=i=>{console.log("调试页面接收到坐标:",i),n(i),r(!1),b.success(`成功接收到 ${i.length} 个坐标点`)};return f("div",{style:{padding:24},children:[f(B,{title:"电子围栏调试页面",children:[e("p",{children:"此页面用于调试电子围栏绘制功能，排除白屏问题。"}),e(D,{type:"primary",onClick:()=>r(!0),style:{marginBottom:16},children:"打开电子围栏绘制"}),a.length>0&&f(B,{title:"绘制结果",size:"small",children:[f("p",{children:["坐标点数量: ",a.length]}),e("div",{style:{maxHeight:200,overflowY:"auto"},children:a.map((i,d)=>f("div",{children:["点 ",d+1,": (",i[0].toFixed(6),", ",i[1].toFixed(6),")"]},d))})]})]}),e(St,{visible:t,onCancel:()=>r(!1),onFinish:o,initialCoordinates:[]})]})},Wl=()=>{const[t,r]=c.useState(!1),[a,n]=c.useState([]),[o,i]=c.useState([]),d=p=>{const y=new Date().toLocaleTimeString();i(u=>[...u,`[${y}] ${p}`]),console.log(`[DebugServiceAreaV2] ${p}`)},m=p=>{d(`接收到 ${p.length} 个坐标点`),n(p),r(!1),b.success(`成功接收到 ${p.length} 个坐标点`)},h=()=>{d("关闭地图模态框"),r(!1)};return f("div",{style:{padding:24},children:[f(B,{title:"电子围栏调试页面 V2",children:[e("p",{children:"此页面用于详细调试电子围栏绘制功能，帮助排查双击后的问题。"}),e(D,{type:"primary",onClick:()=>{d("打开电子围栏绘制"),r(!0)},style:{marginBottom:16},children:"打开电子围栏绘制"}),e(D,{onClick:()=>i([]),style:{marginBottom:16,marginLeft:16},children:"清空日志"}),a.length>0&&f(B,{title:"绘制结果",size:"small",style:{marginBottom:16},children:[f("p",{children:["坐标点数量: ",a.length]}),e("div",{style:{maxHeight:200,overflowY:"auto"},children:a.map((p,y)=>f("div",{children:["点 ",y+1,": (",p[0].toFixed(6),", ",p[1].toFixed(6),")"]},y))})]}),e(B,{title:"调试日志",size:"small",children:e("div",{style:{maxHeight:300,overflowY:"auto"},children:o.length===0?e("p",{children:"暂无日志"}):o.map((p,y)=>e("div",{style:{padding:"4px 8px",borderBottom:"1px solid #f0f0f0",fontFamily:"monospace",fontSize:"12px"},children:p},y))})})]}),e(St,{visible:t,onCancel:h,onFinish:m,initialCoordinates:[]})]})},Yl=()=>{const[t,r]=c.useState([]),[a,n]=c.useState([]),[o,i]=c.useState([]),[d,m]=c.useState([]),[h,p]=c.useState([]),[y,u]=c.useState(!1),s=async()=>{try{const I=await ce.getStores();I.code===200?r(I.data.records||I.data):b.error(I.message||"获取门店列表失败")}catch{b.error("获取门店列表失败")}},l=async()=>{try{const I=await fr.getAllCarModels();I.code===200?n(I.data.records||I.data):b.error(I.message||"获取车型列表失败")}catch{b.error("获取车型列表失败")}},g=async()=>{try{const I=await ae.getValueAddedServiceTemplateList({current:1,size:100});I.code===200?i(I.data.records||[]):b.error(I.message||"获取增值服务模板列表失败")}catch{b.error("获取增值服务模板列表失败")}},S=async()=>{try{const I=await ae.getCancellationRuleTemplateList({current:1,size:100});I.code===200?m(I.data.records||[]):b.error(I.message||"获取取消规则模板列表失败")}catch{b.error("获取取消规则模板列表失败")}},P=async()=>{try{const I=await ae.getServicePolicyTemplateList({current:1,size:100});I.code===200?p(I.data.records||[]):b.error(I.message||"获取服务政策模板列表失败")}catch{b.error("获取服务政策模板列表失败")}},$=async()=>{u(!0);try{await Promise.all([s(),l(),g(),S(),P()])}catch{b.error("获取数据失败")}finally{u(!1)}};return c.useEffect(()=>{$()},[]),{stores:t,carModels:a,vasTemplates:o,cancellationTemplates:d,policyTemplates:h,loading:y,refresh:$}},Kl=t=>{const[r,a]=c.useState([]),[n,o]=c.useState(!1),[i,d]=c.useState([]),m=async()=>{if(t){o(!0);try{const y=await st.getAvailableVehiclesForProduct(t);if(y.code===200){const u=y.data.map(l=>({id:l.id,licensePlate:l.licensePlate,vehicleStatus:l.vehicleStatus,related:l.related||!1}));a(u);const s=u.filter(l=>l.related).map(l=>l.id);d(s)}else b.error(y.message||"获取车辆信息失败"),a([])}catch{b.error("获取车辆信息失败"),a([])}finally{o(!1)}}},h=async y=>{if(!t)return!1;try{const u=await st.relateVehicles({productId:t,vehicleIds:y});return u.code===200?(b.success("关联成功"),d(y),a(s=>s.map(l=>({...l,related:y.includes(l.id)}))),!0):(b.error(u.message||"关联失败"),!1)}catch{return b.error("关联失败"),!1}},p=async y=>{if(!t)return!1;try{const u=await st.unrelateVehicles({productId:t,vehicleIds:y});if(u.code===200){b.success("取消关联成功");const s=i.filter(l=>!y.includes(l));return d(s),a(l=>l.map(g=>({...g,related:s.includes(g.id)}))),!0}else return b.error(u.message||"取消关联失败"),!1}catch{return b.error("取消关联失败"),!1}};return c.useEffect(()=>{t&&m()},[t]),{vehicles:r,loading:n,relatedVehicles:i,fetchAvailableVehicles:m,relateVehicles:h,unrelateVehicles:p}},Gl=({visible:t,productId:r,onCancel:a,onOk:n})=>{const[o,i]=c.useState([]),{vehicles:d,loading:m,relatedVehicles:h,fetchAvailableVehicles:p,relateVehicles:y,unrelateVehicles:u}=Kl(r);c.useEffect(()=>{t&&r&&p()},[t,r]),c.useEffect(()=>{i(h)},[h]);const s=async()=>{if(r)try{const S=o.filter(I=>!h.includes(Number(I))),P=h.filter(I=>!o.includes(I));let $=!0;S.length>0&&(await y(S.map(Number))||($=!1)),P.length>0&&(await u(P)||($=!1)),$&&(b.success("操作成功"),n())}catch{b.error("操作失败")}};return e(ne,{title:"车辆关联管理",open:t,onCancel:a,onOk:s,width:800,footer:[e(D,{onClick:a,children:"取消"},"back"),e(D,{type:"primary",onClick:s,children:"保存"},"submit")],children:e(Se,{spinning:m,children:e(le,{rowKey:"id",columns:[{title:"车牌号",dataIndex:"licensePlate",key:"licensePlate"},{title:"状态",dataIndex:"vehicleStatus",key:"vehicleStatus",render:S=>{const $={1:{text:"空闲",color:"green"},2:{text:"租出",color:"blue"},3:{text:"维修",color:"orange"},4:{text:"报废",color:"red"}}[S]||{text:"未知",color:"default"};return e(ge,{color:$.color,children:$.text})}},{title:"关联状态",dataIndex:"related",key:"related",render:S=>e(ge,{color:S?"green":"default",children:S?"已关联":"未关联"})}],dataSource:d,rowSelection:{selectedRowKeys:o,onChange:S=>{i(S)}},pagination:!1,scroll:{y:400}})})})},Ql=t=>{const[r,a]=c.useState({}),[n,o]=c.useState(!1),i=async()=>{if(t){o(!0);try{const m=await Je.getPricingsByProductForCalendar(t);if(m.code===200){const h={};Object.keys(m.data).forEach(p=>{h[p]=m.data[p]}),a(h)}else b.error(m.message||"获取特殊定价失败")}catch{b.error("获取特殊定价失败")}finally{o(!1)}}},d=async(m,h)=>{if(!t)return!1;try{if(!h||h<=0){const u=Object.values(r).find(s=>s.priceDate===m);if(u){const s=await Je.deletePricing(u.id);if(s.code===200){const l={...r};return delete l[m],a(l),!0}else return b.error(s.message||"删除定价失败"),!1}return!0}const p=Object.values(r).find(u=>u.priceDate===m);let y=!1;return p?y=(await Je.updatePricing(p.id,{productId:t,priceDate:m,price:Math.round(h*100)})).code===200:y=(await Je.createPricing({productId:t,priceDate:m,price:Math.round(h*100)})).code===200,y?(await i(),!0):(b.error("保存定价失败"),!1)}catch{return b.error("保存定价失败"),!1}};return c.useEffect(()=>{t&&i()},[t]),{pricings:r,loading:n,fetchPricingsForCalendar:i,updatePricing:d}},{Title:Zl,Text:qt}=we,yr=({visible:t,productId:r,onCancel:a,onOk:n})=>{const{pricings:o,loading:i,fetchPricingsForCalendar:d,updatePricing:m}=Ql(r),[h,p]=c.useState(ee()),[y,u]=c.useState(null),[s,l]=c.useState(null),[g,S]=c.useState([]);c.useEffect(()=>{t&&r&&d()},[t,r]),c.useEffect(()=>{P()},[o,h]);const P=()=>{const z=h.startOf("month"),E=h.endOf("month"),w=z.startOf("week"),k=E.endOf("week"),_=[];let ie=w;for(;ie.isBefore(k)||ie.isSame(k,"day");)_.push(ie),ie=ie.add(1,"day");const De=[];let de=[];_.forEach((Pe,at)=>{const Ce=Pe.format("YYYY-MM-DD");Pe.month(),h.month();const je=o[Ce];de.push({key:Ce,date:Pe.date().toString(),dayOfWeek:Pe.format("ddd"),price:je?je.price:null,dateString:Ce}),(at+1)%7===0&&(De.push([...de]),de=[])}),de.length>0&&De.push([...de]),S(De)},$=z=>{u(z);const E=o[z];l(E?E.price/100:null)},I=async()=>{if(!y||!r)return;await m(y,s||0)&&(b.success("保存成功"),u(null),l(null))},q=()=>{p(h.subtract(1,"month"))},U=()=>{p(h.add(1,"month"))},T=()=>{p(ee())},C=()=>f("div",{style:{textAlign:"center",marginBottom:16},children:[e(D,{onClick:q,children:"上个月"}),e(D,{onClick:T,style:{margin:"0 8px"},children:"今天"}),e(D,{onClick:U,children:"下个月"}),e(Zl,{level:4,style:{marginTop:16},children:h.format("YYYY年MM月")})]}),L=[{title:"周/日",dataIndex:"dayOfWeek",width:80,align:"center"},{title:"日期",dataIndex:"date",width:80,align:"center",render:(z,E)=>{const w=ee(E.dateString),k=w.month()===h.month(),_=w.isSame(ee(),"day");return e("div",{style:{color:k?_?"#1890ff":"inherit":"#ccc",fontWeight:_?"bold":"normal",opacity:k?1:.5},children:E.date})}},{title:"价格",dataIndex:"price",align:"center",render:(z,E)=>ee(E.dateString).month()===h.month()?z?f("div",{style:{backgroundColor:"#1890ff",color:"#fff",padding:"2px 8px",borderRadius:4,cursor:"pointer"},onClick:()=>$(E.dateString),children:["¥",(z/100).toFixed(2)]}):e(D,{type:"link",size:"small",onClick:()=>$(E.dateString),children:"设置价格"}):null}],N=()=>g.map((z,E)=>e("div",{style:{marginBottom:16},children:e(le,{columns:L,dataSource:z,pagination:!1,showHeader:E===0,size:"small",onRow:w=>({onClick:()=>{ee(w.dateString).month()===h.month()&&$(w.dateString)}}),rowClassName:w=>ee(w.dateString).month()===h.month()?"":"disabled-row"})},E)),V=()=>{if(!y)return null;const z=ee(y),E=o[y];return f(B,{title:`设置价格 - ${z.format("YYYY年MM月DD日")} (${z.format("dddd")})`,size:"small",style:{marginTop:16},children:[f("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e(qt,{children:"价格:"}),e(G,{value:s,onChange:l,placeholder:"请输入价格",min:0,step:.01,formatter:w=>`¥ ${w}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:w=>w.replace(/¥\s?|(,*)/g,""),style:{width:120}}),e(D,{onClick:I,type:"primary",children:"保存"}),e(D,{onClick:()=>u(null),children:"取消"})]}),E&&f(qt,{type:"secondary",style:{display:"block",marginTop:8},children:["当前已有价格: ¥",(E.price/100).toFixed(2)]})]})};return e(ne,{title:"特殊定价日历",open:t,onCancel:a,onOk:n,width:800,footer:[e(D,{onClick:a,children:"关闭"},"back")],children:f(Se,{spinning:i,children:[C(),e("div",{style:{maxHeight:"400px",overflowY:"auto"},children:N()}),V()]})})},Xl=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState(!1),[d,m]=c.useState(null),[h,p]=c.useState(!1),[y,u]=c.useState(!1),[s,l]=c.useState(null),[g]=v.useForm(),[S]=v.useForm(),[P,$]=c.useState({current:1,pageSize:10,total:0}),{stores:I,carModels:q,vasTemplates:U,cancellationTemplates:T,policyTemplates:C,refresh:L}=Yl(),N=async(x=1,F=10,H={})=>{n(!0);try{const j=await Re.getProductList({current:x,size:F,...H});j.code===200?(r(j.data.records),$({current:j.data.pageNum,pageSize:j.data.pageSize,total:j.data.total})):b.error(j.message||"获取商品列表失败")}catch{b.error("获取商品列表失败")}finally{n(!1)}},V=x=>{const{current:F,pageSize:H}=x,j=S.getFieldsValue(),te=Object.fromEntries(Object.entries(j).filter(([Ie,oe])=>oe!=null&&oe!==""));N(F,H,te)},z=()=>{const x=S.getFieldsValue(),F=Object.fromEntries(Object.entries(x).filter(([H,j])=>j!=null&&j!==""));N(1,P.pageSize,F)},E=()=>{S.resetFields(),N(1,P.pageSize,{})},w=x=>{if(x){m(x);const F=x.weekdayDefinition?x.weekdayDefinition.split(","):[],H=x.weekendDefinition?x.weekendDefinition.split(","):[];g.setFieldsValue({...x,damageDeposit:x.damageDeposit/100,violationDeposit:x.violationDeposit/100,weekdayPrice:x.weekdayPrice/100,weekendPrice:x.weekendPrice/100,weekdayDefinition:F,weekendDefinition:H})}else m(null),g.resetFields(),g.setFieldsValue({weekdayDefinition:je,weekendDefinition:vr});i(!0)},k=()=>{i(!1),g.resetFields(),m(null)},_=x=>{l(x),p(!0)},ie=()=>{p(!1),l(null)},De=x=>{l(x),u(!0)},de=()=>{u(!1),l(null)},Pe=async x=>{const F=x.weekdayDefinition||[],H=x.weekendDefinition||[];if(F.filter(te=>H.includes(te)).length>0){b.error("周中定义和周末定义不能有重复的天数");return}try{const te={...x,weekdayDefinition:F.join(","),weekendDefinition:H.join(","),damageDeposit:Math.round(x.damageDeposit*100),violationDeposit:Math.round(x.violationDeposit*100),weekdayPrice:Math.round(x.weekdayPrice*100),weekendPrice:Math.round(x.weekendPrice*100)};let Ie;if(d?Ie=await Re.updateProduct(d.id,te):Ie=await Re.createProduct(te),Ie.code===200){b.success(d?"更新成功":"添加成功"),k();const oe=S.getFieldsValue(),xr=Object.fromEntries(Object.entries(oe).filter(([li,lt])=>lt!=null&&lt!==""));N(P.current,P.pageSize,xr)}else b.error(Ie.message||(d?"更新失败":"添加失败"))}catch{b.error(d?"更新失败":"添加失败")}},at=async(x,F)=>{try{const H=F===1?await Re.onlineProduct(x):await Re.offlineProduct(x);if(H.code===200){b.success(F===1?"上架成功":"下架成功");const j=S.getFieldsValue(),te=Object.fromEntries(Object.entries(j).filter(([Ie,oe])=>oe!=null&&oe!==""));N(P.current,P.pageSize,te)}else b.error(H.message||(F===1?"上架失败":"下架失败"))}catch{b.error(F===1?"上架失败":"下架失败")}},Ce=[{label:"周一",value:"1"},{label:"周二",value:"2"},{label:"周三",value:"3"},{label:"周四",value:"4"},{label:"周五",value:"5"},{label:"周六",value:"6"},{label:"周日",value:"7"}],je=["1","2","3","4","5"],vr=["6","7"],br=x=>{const F=g.getFieldValue("weekendDefinition")||[];if(x.filter(j=>F.includes(j)).length>0){const j=F.filter(te=>!x.includes(te));g.setFieldsValue({weekendDefinition:j})}},Sr=x=>{const F=g.getFieldValue("weekdayDefinition")||[];if(x.filter(j=>F.includes(j)).length>0){const j=F.filter(te=>!x.includes(te));g.setFieldsValue({weekdayDefinition:j})}};c.useEffect(()=>{N()},[]);const wr=[{title:"ID",dataIndex:"id",width:80},{title:"商品名称",dataIndex:"productName",sorter:!0},{title:"门店",dataIndex:"storeId",render:x=>{const F=I.find(H=>H.id===x);return F?F.storeName:x}},{title:"车型",dataIndex:"carModelId",render:x=>{const F=q.find(H=>H.id===x);return F?`${F.brand} ${F.series} ${F.model}`:x}},{title:"周中价格(元)",dataIndex:"weekdayPrice",render:x=>(x/100).toFixed(2)},{title:"周末价格(元)",dataIndex:"weekendPrice",render:x=>(x/100).toFixed(2)},{title:"车损押金(元)",dataIndex:"damageDeposit",render:x=>(x/100).toFixed(2)},{title:"违章押金(元)",dataIndex:"violationDeposit",render:x=>(x/100).toFixed(2)},{title:"状态",dataIndex:"onlineStatus",render:x=>e(ge,{color:x===1?"green":"red",children:x===1?"已上架":"已下架"})},{title:"创建时间",dataIndex:"createdTime",render:x=>new Date(x).toLocaleString()},{title:"操作",key:"action",width:250,render:(x,F)=>f(W,{size:"middle",children:[e(D,{type:"link",icon:e(pe,{}),onClick:()=>w(F),children:"编辑"}),e(D,{type:"link",onClick:()=>_(F.id),children:"关联车辆"}),e(D,{type:"link",onClick:()=>De(F.id),children:"特殊定价"}),e(D,{type:"link",icon:F.onlineStatus===1?e(Nt,{}):e(Nt,{}),onClick:()=>at(F.id,F.onlineStatus===1?0:1),children:F.onlineStatus===1?"下架":"上架"})]})}];return f(ye,{title:"商品管理",children:[f(B,{children:[e(v,{form:S,layout:"inline",onFinish:z,children:f(J,{gutter:16,style:{width:"100%"},children:[e(A,{span:6,children:e(v.Item,{name:"productName",label:"商品名称",children:e(R,{placeholder:"请输入商品名称"})})}),e(A,{span:6,children:e(v.Item,{name:"storeId",label:"门店",children:e(O,{placeholder:"请选择门店",allowClear:!0,children:I.map(x=>e(O.Option,{value:x.id,children:x.storeName},x.id))})})}),e(A,{span:6,children:e(v.Item,{name:"onlineStatus",label:"上架状态",children:f(O,{placeholder:"请选择状态",allowClear:!0,children:[e(O.Option,{value:1,children:"已上架"}),e(O.Option,{value:0,children:"已下架"})]})})}),e(A,{span:6,children:e(v.Item,{children:f(W,{children:[e(D,{type:"primary",htmlType:"submit",icon:e(Lr,{}),children:"搜索"}),e(D,{onClick:E,children:"重置"})]})})})]})}),e(mt,{}),e("div",{style:{marginBottom:16},children:e(D,{type:"primary",icon:e(Ee,{}),onClick:()=>w(),children:"新增商品"})}),e(le,{columns:wr,dataSource:t,loading:a,pagination:{...P,showSizeChanger:!0,showQuickJumper:!0},onChange:V,rowKey:"id"})]}),e(ne,{title:d?"编辑商品":"新增商品",open:o,onCancel:k,footer:null,width:800,children:f(v,{form:g,layout:"vertical",onFinish:Pe,children:[f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"storeId",label:"门店",rules:[{required:!0,message:"请选择门店"}],children:e(O,{placeholder:"请选择门店",children:I.map(x=>e(O.Option,{value:x.id,children:x.storeName},x.id))})})}),e(A,{span:12,children:e(v.Item,{name:"productName",label:"商品名称",rules:[{required:!0,message:"请输入商品名称"}],children:e(R,{placeholder:"请输入商品名称"})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"carModelId",label:"车型",rules:[{required:!0,message:"请选择车型"}],children:e(O,{placeholder:"请选择车型",showSearch:!0,optionFilterProp:"children",filterOption:(x,F)=>{var H;return((H=F==null?void 0:F.children)==null?void 0:H.toLowerCase().indexOf(x.toLowerCase()))>=0},children:q.map(x=>e(O.Option,{value:x.id,children:`${x.brand} ${x.series} ${x.model}`},x.id))})})}),e(A,{span:12,children:e(v.Item,{name:"weekdayPrice",label:"周中价格(元)",rules:[{required:!0,message:"请输入周中价格"}],children:e(G,{placeholder:"请输入周中价格",min:0,step:.01,style:{width:"100%"}})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"weekendPrice",label:"周末价格(元)",rules:[{required:!0,message:"请输入周末价格"}],children:e(G,{placeholder:"请输入周末价格",min:0,step:.01,style:{width:"100%"}})})}),e(A,{span:12,children:e(v.Item,{name:"damageDeposit",label:"车损押金(元)",rules:[{required:!0,message:"请输入车损押金"}],children:e(G,{placeholder:"请输入车损押金",min:0,step:.01,style:{width:"100%"}})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"violationDeposit",label:"违章押金(元)",rules:[{required:!0,message:"请输入违章押金"}],children:e(G,{placeholder:"请输入违章押金",min:0,step:.01,style:{width:"100%"}})})}),e(A,{span:12,children:e(v.Item,{name:"vasTemplateId",label:"基础保障模板",children:e(O,{placeholder:"请选择基础保障模板",allowClear:!0,children:U.filter(x=>x.serviceType===1).map(x=>e(O.Option,{value:x.id,children:x.templateName},x.id))})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"vasTemplateIdVip",label:"优享保障模板",children:e(O,{placeholder:"请选择优享保障模板",allowClear:!0,children:U.filter(x=>x.serviceType===2).map(x=>e(O.Option,{value:x.id,children:x.templateName},x.id))})})}),e(A,{span:12,children:e(v.Item,{name:"vasTemplateIdVvip",label:"尊享保障模板",children:e(O,{placeholder:"请选择尊享保障模板",allowClear:!0,children:U.filter(x=>x.serviceType===3).map(x=>e(O.Option,{value:x.id,children:x.templateName},x.id))})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"cancellationTemplateId",label:"取消规则模板",children:e(O,{placeholder:"请选择取消规则模板",allowClear:!0,children:T.map(x=>e(O.Option,{value:x.id,children:x.templateName},x.id))})})}),e(A,{span:12,children:e(v.Item,{name:"servicePolicyTemplateId",label:"服务政策模板",children:e(O,{placeholder:"请选择服务政策模板",allowClear:!0,children:C.map(x=>e(O.Option,{value:x.id,children:x.templateName},x.id))})})})]}),e(v.Item,{name:"weekdayDefinition",label:"周中定义",rules:[{required:!0,message:"请选择周中定义"}],children:e(wt.Group,{options:Ce,onChange:br})}),e(v.Item,{name:"weekendDefinition",label:"周末定义",rules:[{required:!0,message:"请选择周末定义"}],children:e(wt.Group,{options:Ce,onChange:Sr})}),e(v.Item,{name:"productDescription",label:"商品描述",children:e(R.TextArea,{placeholder:"请输入商品描述",rows:3})}),e(v.Item,{children:f(W,{children:[e(D,{type:"primary",htmlType:"submit",children:d?"更新":"添加"}),e(D,{onClick:k,children:"取消"})]})})]})}),h&&e(Gl,{visible:h,productId:s,onCancel:ie,onOk:ie}),y&&e(yr,{visible:y,productId:s,onCancel:de,onOk:de})]})},ei=()=>{const[t,r]=c.useState("vas"),[a,n]=c.useState([]),[o,i]=c.useState([]),[d,m]=c.useState([]),[h,p]=c.useState(!1),[y,u]=c.useState(!1),[s,l]=c.useState(null),[g]=v.useForm();v.useForm();const[S,P]=c.useState({current:1,pageSize:10,total:0}),$=async(E,w=1,k=10)=>{p(!0);try{let _;switch(E){case"vas":_=await ae.getValueAddedServiceTemplateList({current:w,size:k}),_.code===200&&(n(_.data.records),P({current:_.data.pageNum,pageSize:_.data.pageSize,total:_.data.total}));break;case"cancellation":_=await ae.getCancellationRuleTemplateList({current:w,size:k}),_.code===200&&(i(_.data.records),P({current:_.data.pageNum,pageSize:_.data.pageSize,total:_.data.total}));break;case"policy":_=await ae.getServicePolicyTemplateList({current:w,size:k}),_.code===200&&(m(_.data.records),P({current:_.data.pageNum,pageSize:_.data.pageSize,total:_.data.total}));break}_&&_.code!==200&&b.error(_.message||"获取模板列表失败")}catch{b.error("获取模板列表失败")}finally{p(!1)}},I=E=>{const{current:w,pageSize:k}=E;$(t,w,k)},q=E=>{r(E),$(E,1,S.pageSize)},U=E=>{E?(l(E),g.setFieldsValue({...E,price:E.price?E.price/100:void 0,deductible:E.deductible?E.deductible/100:void 0,depreciationDeductible:E.depreciationDeductible?E.depreciationDeductible/100:void 0})):(l(null),g.resetFields()),u(!0)},T=()=>{u(!1),g.resetFields(),l(null)},C=async E=>{try{const w={...E,price:E.price?Math.round(E.price*100):void 0,deductible:E.deductible?Math.round(E.deductible*100):void 0,depreciationDeductible:E.depreciationDeductible?Math.round(E.depreciationDeductible*100):void 0};let k;if(s)switch(t){case"vas":k=await ae.updateValueAddedServiceTemplate(s.id,w);break;case"cancellation":k=await ae.updateCancellationRuleTemplate(s.id,w);break;case"policy":k=await ae.updateServicePolicyTemplate(s.id,w);break}else switch(t){case"vas":k=await ae.createValueAddedServiceTemplate(w);break;case"cancellation":k=await ae.createCancellationRuleTemplate(w);break;case"policy":k=await ae.createServicePolicyTemplate(w);break}k&&k.code===200?(b.success(s?"更新成功":"添加成功"),T(),$(t,S.current,S.pageSize)):b.error((k==null?void 0:k.message)||(s?"更新失败":"添加失败"))}catch{b.error(s?"更新失败":"添加失败")}};c.useEffect(()=>{$(t)},[]);const L=[{title:"ID",dataIndex:"id",width:80},{title:"模板名称",dataIndex:"templateName"},{title:"服务类型",dataIndex:"serviceType",render:E=>{switch(E){case 1:return"基础保障";case 2:return"优享保障";case 3:return"尊享保障";default:return"-"}}},{title:"价格(元)",dataIndex:"price",render:E=>(E/100).toFixed(2)},{title:"起赔额(元)",dataIndex:"deductible",render:E=>(E/100).toFixed(2)},{title:"创建时间",dataIndex:"createdTime",render:E=>new Date(E).toLocaleString()},{title:"操作",key:"action",width:150,render:(E,w)=>e(W,{size:"middle",children:e(D,{type:"link",icon:e(pe,{}),onClick:()=>U(w),children:"编辑"})})}],N=[{title:"ID",dataIndex:"id",width:80},{title:"模板名称",dataIndex:"templateName"},{title:"平日规则",dataIndex:"weekdayRule"},{title:"节假日规则",dataIndex:"holidayRule"},{title:"创建时间",dataIndex:"createdTime",render:E=>new Date(E).toLocaleString()},{title:"操作",key:"action",width:150,render:(E,w)=>e(W,{size:"middle",children:e(D,{type:"link",icon:e(pe,{}),onClick:()=>U(w),children:"编辑"})})}],V=[{title:"ID",dataIndex:"id",width:80},{title:"模板名称",dataIndex:"templateName"},{title:"里程限制",dataIndex:"mileageLimit"},{title:"创建时间",dataIndex:"createdTime",render:E=>new Date(E).toLocaleString()},{title:"操作",key:"action",width:150,render:(E,w)=>e(W,{size:"middle",children:e(D,{type:"link",icon:e(pe,{}),onClick:()=>U(w),children:"编辑"})})}],z=[{key:"vas",label:"增值服务模板",children:e(le,{columns:L,dataSource:a,loading:h,pagination:{...S,showSizeChanger:!0,showQuickJumper:!0},onChange:I,rowKey:"id"})},{key:"cancellation",label:"取消规则模板",children:e(le,{columns:N,dataSource:o,loading:h,pagination:{...S,showSizeChanger:!0,showQuickJumper:!0},onChange:I,rowKey:"id"})},{key:"policy",label:"服务政策模板",children:e(le,{columns:V,dataSource:d,loading:h,pagination:{...S,showSizeChanger:!0,showQuickJumper:!0},onChange:I,rowKey:"id"})}];return f(ye,{title:"模板管理",children:[f(B,{children:[e("div",{style:{marginBottom:16},children:e(D,{type:"primary",icon:e(Ee,{}),onClick:()=>U(),children:"新增模板"})}),e(zr,{activeKey:t,items:z,onChange:q})]}),e(ne,{title:s?"编辑模板":"新增模板",open:y,onCancel:T,footer:null,width:800,children:f(v,{form:g,layout:"vertical",onFinish:C,children:[t==="vas"&&f(fe,{children:[e(v.Item,{name:"templateName",label:"模板名称",rules:[{required:!0,message:"请输入模板名称"}],children:e(R,{placeholder:"请输入模板名称"})}),e(v.Item,{name:"serviceType",label:"服务类型",rules:[{required:!0,message:"请选择服务类型"}],children:f(O,{placeholder:"请选择服务类型",children:[e(O.Option,{value:1,children:"基础保障"}),e(O.Option,{value:2,children:"优享保障"}),e(O.Option,{value:3,children:"尊享保障"})]})}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"price",label:"价格(元)",rules:[{required:!0,message:"请输入价格"}],children:e(G,{placeholder:"请输入价格",min:0,step:.01,style:{width:"100%"}})})}),e(A,{span:12,children:e(v.Item,{name:"deductible",label:"起赔额(元)",rules:[{required:!0,message:"请输入起赔额"}],children:e(G,{placeholder:"请输入起赔额",min:0,step:.01,style:{width:"100%"}})})})]}),f(J,{gutter:16,children:[e(A,{span:8,children:e(v.Item,{name:"includeTireDamage",label:"包含轮胎损失",rules:[{required:!0,message:"请选择是否包含轮胎损失"}],children:f(O,{placeholder:"请选择",children:[e(O.Option,{value:0,children:"否"}),e(O.Option,{value:1,children:"是"})]})})}),e(A,{span:8,children:e(v.Item,{name:"includeGlassDamage",label:"包含玻璃损失",rules:[{required:!0,message:"请选择是否包含玻璃损失"}],children:f(O,{placeholder:"请选择",children:[e(O.Option,{value:0,children:"否"}),e(O.Option,{value:1,children:"是"})]})})}),e(A,{span:8,children:e(v.Item,{name:"chargeDepreciation",label:"收取折旧费",rules:[{required:!0,message:"请选择是否收取折旧费"}],children:f(O,{placeholder:"请选择",children:[e(O.Option,{value:0,children:"否"}),e(O.Option,{value:1,children:"是"})]})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"thirdPartyCoverage",label:"第三方保障(万元)",rules:[{required:!0,message:"请输入第三方保障"}],children:e(G,{placeholder:"请输入第三方保障",min:0,style:{width:"100%"}})})}),e(A,{span:12,children:e(v.Item,{name:"depreciationDeductible",label:"折旧费免赔额(元)",rules:[{required:!0,message:"请输入折旧费免赔额"}],children:e(G,{placeholder:"请输入折旧费免赔额",min:0,step:.01,style:{width:"100%"}})})})]}),e(v.Item,{name:"depreciationRate",label:"折旧费收取比例(%)",rules:[{required:!0,message:"请输入折旧费收取比例"}],children:e(G,{placeholder:"请输入折旧费收取比例",min:0,max:100,style:{width:"100%"}})})]}),t==="cancellation"&&f(fe,{children:[e(v.Item,{name:"templateName",label:"模板名称",rules:[{required:!0,message:"请输入模板名称"}],children:e(R,{placeholder:"请输入模板名称"})}),e(v.Item,{name:"weekdayRule",label:"平日取消规则",rules:[{required:!0,message:"请输入平日取消规则"}],children:e(R.TextArea,{placeholder:"请输入平日取消规则",rows:3})}),e(v.Item,{name:"holidayRule",label:"节假日取消规则",rules:[{required:!0,message:"请输入节假日取消规则"}],children:e(R.TextArea,{placeholder:"请输入节假日取消规则",rows:3})})]}),t==="policy"&&f(fe,{children:[e(v.Item,{name:"templateName",label:"模板名称",rules:[{required:!0,message:"请输入模板名称"}],children:e(R,{placeholder:"请输入模板名称"})}),e(v.Item,{name:"mileageLimit",label:"里程限制",children:e(R,{placeholder:"请输入里程限制"})}),e(v.Item,{name:"earlyPickup",label:"提前取车",children:e(R,{placeholder:"请输入提前取车规则"})}),e(v.Item,{name:"latePickup",label:"延迟取车",children:e(R,{placeholder:"请输入延迟取车规则"})}),e(v.Item,{name:"earlyReturn",label:"提前还车",children:e(R,{placeholder:"请输入提前还车规则"})}),e(v.Item,{name:"renewal",label:"续租",children:e(R,{placeholder:"请输入续租规则"})}),e(v.Item,{name:"forcedRenewal",label:"强行续租",children:e(R,{placeholder:"请输入强行续租规则"})}),e(v.Item,{name:"pickupMaterials",label:"取车材料",children:e(R,{placeholder:"请输入取车所需材料"})}),e(v.Item,{name:"cityRestriction",label:"城市限行规则",children:e(R,{placeholder:"请输入城市限行规则"})}),e(v.Item,{name:"usageAreaLimit",label:"用车区域限制",children:e(R,{placeholder:"请输入用车区域限制"})}),e(v.Item,{name:"fuelFee",label:"油费电费",children:e(R,{placeholder:"请输入油费电费规则"})}),e(v.Item,{name:"personalBelongingsLoss",label:"随车物品损失",children:e(R,{placeholder:"请输入随车物品损失规则"})}),e(v.Item,{name:"violationHandling",label:"违章处理",children:e(R,{placeholder:"请输入违章处理规则"})}),e(v.Item,{name:"roadsideAssistance",label:"道路救援",children:e(R,{placeholder:"请输入道路救援规则"})}),e(v.Item,{name:"forcedRecovery",label:"强制收车",children:e(R,{placeholder:"请输入强制收车规则"})}),e(v.Item,{name:"etcFee",label:"ETC费用",children:e(R,{placeholder:"请输入ETC费用规则"})}),e(v.Item,{name:"cleaningFee",label:"清洁费",children:e(R,{placeholder:"请输入清洁费规则"})}),e(v.Item,{name:"invoiceInfo",label:"发票说明",children:e(R,{placeholder:"请输入发票说明"})})]}),e(v.Item,{children:f(W,{children:[e(D,{type:"primary",htmlType:"submit",children:s?"更新":"添加"}),e(D,{onClick:T,children:"取消"})]})})]})})]})},ti=()=>{const[t,r]=c.useState(!1),[a]=c.useState(1);return f("div",{style:{padding:24},children:[e(B,{title:"特殊定价日历测试",children:e(W,{children:e(D,{type:"primary",onClick:()=>r(!0),children:"打开特殊定价日历"})})}),e(yr,{visible:t,productId:a,onCancel:()=>r(!1),onOk:()=>r(!1)})]})},ri=()=>{const[t,r]=c.useState([]),[a,n]=c.useState(!1),[o,i]=c.useState({current:1,pageSize:10,total:0});return{employees:t,loading:a,pageInfo:o,getEmployees:async u=>{n(!0);try{const s=await Ne.getEmployees(u),l=s.data;return r(l.records||[]),i({current:l.pageNum||(u==null?void 0:u.current)||1,pageSize:l.pageSize||(u==null?void 0:u.size)||10,total:l.total||0}),s}catch(s){throw b.error(s.message||"获取员工列表失败"),s}finally{n(!1)}},createEmployee:async u=>{try{const s=await Ne.createEmployee(u);return b.success("员工创建成功"),s}catch(s){throw b.error(s.message||"创建员工失败"),s}},updateEmployee:async u=>{try{const s=await Ne.updateEmployee(u);return b.success("员工更新成功"),s}catch(s){throw b.error(s.message||"更新员工失败"),s}},deleteEmployee:async u=>{try{const s=await Ne.deleteEmployee(u);return b.success("员工删除成功"),s}catch(s){throw b.error(s.message||"删除员工失败"),s}},resetPassword:async u=>{try{const s=await Ne.resetPassword(u);return b.success("密码重置成功"),s}catch(s){throw b.error(s.message||"密码重置失败"),s}}}},{Option:ve}=O,ni=()=>{const{employees:t,loading:r,pageInfo:a,getEmployees:n,createEmployee:o,updateEmployee:i,deleteEmployee:d,resetPassword:m}=ri(),[h,p]=c.useState(!1),[y,u]=c.useState(null),[s]=v.useForm(),[l,g]=c.useState([]),S=async()=>{var N;try{const V=await ce.getStores(),z=((N=V.data)==null?void 0:N.records)||V.data||[];g(z)}catch(V){b.error("获取门店列表失败: "+(V.message||"未知错误")),g([{id:1,storeName:"总店"},{id:2,storeName:"分店1"},{id:3,storeName:"分店2"}])}},P=(N,V)=>{n({current:N,size:V})},$=async N=>{try{await d(N),n()}catch{}},I=()=>{u(null),s.resetFields(),p(!0)},q=N=>{u(N),s.setFieldsValue({...N,password:void 0}),p(!0)},U=async N=>{try{await m(N)}catch{}},T=async N=>{try{y?await i({...N,id:y.id}):await o(N),p(!1),s.resetFields(),n()}catch{}},C=()=>{p(!1),s.resetFields()};return c.useEffect(()=>{n(),S()},[]),f(ye,{title:"员工管理",children:[e(B,{title:"员工列表",extra:e(D,{type:"primary",icon:e(Ee,{}),onClick:I,children:"新增员工"}),children:e(le,{columns:[{title:"员工姓名",dataIndex:"employeeName",key:"employeeName"},{title:"所属门店",dataIndex:"storeId",key:"storeId",render:N=>{const V=l.find(z=>z.id===N);return V?V.storeName:"未分配"}},{title:"用户名",dataIndex:"username",key:"username"},{title:"手机号",dataIndex:"phone",key:"phone"},{title:"角色类型",dataIndex:"roleTypeDesc",key:"roleTypeDesc"},{title:"状态",dataIndex:"statusDesc",key:"statusDesc",render:(N,V)=>e(ge,{color:V.status===1?"green":"red",children:N})},{title:"最后登录时间",dataIndex:"lastLoginTime",key:"lastLoginTime",render:N=>N||"从未登录"},{title:"操作",key:"action",render:(N,V)=>f(W,{size:"middle",children:[e(D,{type:"link",icon:e(pe,{}),onClick:()=>q(V),children:"编辑"}),e(Oe,{title:"重置密码",description:"确定要重置该员工的密码吗？",onConfirm:()=>U(V.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",children:"重置密码"})}),e(Oe,{title:"删除员工",description:"确定要删除这个员工吗？",onConfirm:()=>$(V.id),okText:"确定",cancelText:"取消",children:e(D,{type:"link",danger:!0,icon:e(Ye,{}),children:"删除"})})]})}],dataSource:t,loading:r,rowKey:"id",pagination:{current:a.current,pageSize:a.pageSize,total:a.total,onChange:P,showSizeChanger:!0,showQuickJumper:!0}})}),e(ne,{title:y?"编辑员工":"新增员工",open:h,onCancel:C,onOk:()=>s.submit(),width:600,children:f(v,{form:s,layout:"vertical",onFinish:T,children:[f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"employeeName",label:"员工姓名",rules:[{required:!0,message:"请输入员工姓名"}],children:e(R,{placeholder:"请输入员工姓名"})})}),e(A,{span:12,children:e(v.Item,{name:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"}],children:e(R,{placeholder:"请输入用户名"})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}],children:e(R,{placeholder:"请输入手机号"})})}),e(A,{span:12,children:e(v.Item,{name:"storeId",label:"所属门店",rules:[{required:!0,message:"请选择所属门店"}],children:e(O,{placeholder:"请选择所属门店",children:l.map(N=>e(ve,{value:N.id,children:N.storeName},N.id))})})})]}),f(J,{gutter:16,children:[e(A,{span:12,children:e(v.Item,{name:"roleType",label:"角色类型",rules:[{required:!0,message:"请选择角色类型"}],children:f(O,{placeholder:"请选择角色类型",children:[e(ve,{value:2,children:"门店管理员"}),e(ve,{value:3,children:"车辆管理员"}),e(ve,{value:4,children:"订单管理员"}),e(ve,{value:5,children:"普通员工"})]})})}),e(A,{span:12,children:e(v.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}],children:f(O,{placeholder:"请选择状态",children:[e(ve,{value:1,children:"启用"}),e(ve,{value:0,children:"禁用"})]})})})]}),!y&&e(J,{gutter:16,children:e(A,{span:12,children:e(v.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码"}],children:e(R.Password,{placeholder:"请输入密码"})})})})]})})]})};function ai(){return e(na,{children:e("div",{className:"App",children:f(ea,{children:[e(K,{path:"/login",element:e(wl,{})}),e(K,{path:"/register",element:e(Ul,{})}),e(K,{path:"/register-success",element:e(jl,{})}),e(K,{path:"/debug",element:e(Hl,{})}),e(K,{path:"/dashboard",element:e(ue,{children:e(Tl,{})})}),e(K,{path:"/stores",element:e(ue,{children:e($l,{})})}),e(K,{path:"/vehicles",element:e(ue,{children:e(zl,{})})}),e(K,{path:"/orders",element:e(ue,{children:e(Vl,{})})}),e(K,{path:"/debug-service-area",element:e(Jl,{})}),e(K,{path:"/debug-service-area-v2",element:e(Wl,{})}),e(K,{path:"/products",element:e(ue,{children:e(Xl,{})})}),e(K,{path:"/templates",element:e(ue,{children:e(ei,{})})}),e(K,{path:"/pricing-calendar-test",element:e(ue,{children:e(ti,{})})}),e(K,{path:"/employees",element:e(ue,{children:e(ni,{})})}),e(K,{path:"/",element:e(mr,{to:"/dashboard",replace:!0})})]})})})}pt.createRoot(document.getElementById("root")).render(e(Bt.StrictMode,{children:e(Fr,{locale:un,children:e(ai,{})})}));
